!function(t){"use strict";function n(t){return t}var e=function(t){function n(){return r}var r=t;return{get:n,set:function(t){r=t},clone:function(){return e(n())}}},r=function(){},o=function(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t(n.apply(null,e))}},i=function(t){return function(){return t}};function u(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=n.concat(e);return t.apply(null,o)}}function c(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return!t.apply(null,n)}}function a(){return d}var l,f=i(!1),s=i(!0),d=(l={fold:function(t,n){return t()},is:f,isSome:f,isNone:s,getOr:p,getOrThunk:g,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:p,orThunk:g,map:a,each:r,bind:a,exists:f,forall:s,filter:a,equals:m,equals_:m,toArray:function(){return[]},toString:i("none()")},Object.freeze&&Object.freeze(l),l);function m(t){return t.isNone()}function g(t){return t()}function p(t){return t}function h(t){return function(n){return function(t){if(null===t)return"null";var n=typeof t;return"object"==n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}}function v(t,n){return-1<function(t,n){return zt.call(t,n)}(t,n)}function b(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return!0;return!1}function w(t,n){for(var e=t.length,r=new Array(e),o=0;o<e;o++){var i=t[o];r[o]=n(i,o)}return r}function y(t,n){for(var e=0,r=t.length;e<r;e++)n(t[e],e)}function C(t,n){for(var e=[],r=0,o=t.length;r<o;r++){var i=t[r];n(i,r)&&e.push(i)}return e}function x(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e])}(t,(function(t){e=n(e,t)})),e}function S(t,n,e){return y(t,(function(t){e=n(e,t)})),e}function R(t,n){for(var e=0,r=t.length;e<r;e++){var o=t[e];if(n(o,e))return Bt.some(o)}return Bt.none()}function T(t,n){for(var e=0,r=t.length;e<r;e++)if(n(t[e],e))return Bt.some(e);return Bt.none()}function O(t){for(var n=[],e=0,r=t.length;e<r;++e){if(!Mt(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);Ht.apply(n,t[e])}return n}function D(t,n){return O(w(t,n))}function A(t,n){for(var e=0,r=t.length;e<r;++e)if(!0!==n(t[e],e))return!1;return!0}function E(t){var n=jt.call(t,0);return n.reverse(),n}function N(t,n){for(var e=Ft(t),r=0,o=e.length;r<o;r++){var i=e[r];n(t[i],i)}}function P(t,n){return qt(t,(function(t,e){return{k:e,v:n(t,e)}}))}function B(t,n){return Vt(t,n)?Bt.from(t[n]):Bt.none()}function I(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(t.length!==n.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+n.length+" arguments");var r={};return y(t,(function(t,e){r[t]=i(n[e])})),r}}function k(t){return t.slice(0).sort()}function M(t,n){throw new Error("All required keys ("+k(t).join(", ")+") were not specified. Specified keys were: "+k(n).join(", ")+".")}function W(t){throw new Error("Unsupported keys for object: "+k(t).join(", "))}function _(t,n){if(!Mt(n))throw new Error("The "+t+" fields must be an array. Was: "+n+".");y(n,(function(n){if(!kt(n))throw new Error("The value "+n+" in the "+t+" fields was not a string.")}))}function L(t){var n=k(t);R(n,(function(t,e){return e<n.length-1&&t===n[e+1]})).each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+n.join(", ")+"].")}))}function j(t){return t.dom().nodeType}function z(t){return function(n){return j(n)===t}}function H(t){return j(t)===Yt||"#comment"===Jt(t)}function F(n,e,r){if(!(kt(r)||Wt(r)||Lt(r)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",r,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,r+"")}function U(t,n,e){F(t.dom(),n,e)}function q(t,n){var e=t.dom();N(n,(function(t,n){F(e,n,t)}))}function V(t,n){var e=t.dom().getAttribute(n);return null===e?void 0:e}function G(t,n){var e=t.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(n)}function Y(t,n){t.dom().removeAttribute(n)}function K(t){return S(t.dom().attributes,(function(t,n){return t[n.name]=n.value,t}),{})}function X(t,n,e){return""===n||!(t.length<n.length)&&t.substr(e,e+n.length)===n}function $(t,n){return-1!==t.indexOf(n)}function J(t,n){return X(t,n,0)}function Q(t){return void 0!==t.style&&_t(t.style.getPropertyValue)}function Z(t){var n,e=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return e||(e=!0,n=t.apply(null,r)),n}}function tt(t){var n=Zt(t)?t.dom().parentNode:t.dom();return null!=n&&n.ownerDocument.body.contains(n)}function nt(n,e,r){if(!kt(r))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",r,":: Element ",n),new Error("CSS value must be a string: "+r);Q(n)&&n.style.setProperty(e,r)}function et(t,n,e){nt(t.dom(),n,e)}function rt(t,n){var e=t.dom();N(n,(function(t,n){nt(e,n,t)}))}function ot(n,e){var r=n.dom(),o=t.window.getComputedStyle(r).getPropertyValue(e),i=""!==o||tt(n)?o:on(r,e);return null===i?void 0:i}function it(t,n){var e=t.dom(),r=on(e,n);return Bt.from(r).filter((function(t){return 0<t.length}))}function ut(t,n){!function(t,n){Q(t)&&t.style.removeProperty(n)}(t.dom(),n),G(t,"style")&&""===function(t){return t.replace(/^\s+|\s+$/g,"")}(V(t,"style"))&&Y(t,"style")}function ct(t,n){return function(){return n===t}}function at(t,n){return function(){return n===t}}function lt(t,n){var e=String(n).toLowerCase();return R(t,(function(t){return t.search(e)}))}function ft(t){return function(n){return $(n,t)}}function st(){return On.get()}function dt(t,n){var e=t.dom();if(e.nodeType!==Dn)return!1;var r=e;if(void 0!==r.matches)return r.matches(n);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(n);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(n);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function mt(t){return t.nodeType!==Dn&&t.nodeType!==An||0===t.childElementCount}function gt(t){return nn.fromDom(t.dom().ownerDocument)}function pt(t){return Bt.from(t.dom().parentNode).map(nn.fromDom)}function ht(t,n){for(var e=_t(n)?n:f,r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=nn.fromDom(i);if(o.push(u),!0===e(u))break;r=i}return o}function vt(t){return Bt.from(t.dom().previousSibling).map(nn.fromDom)}function bt(t){return Bt.from(t.dom().nextSibling).map(nn.fromDom)}function wt(t){return w(t.dom().childNodes,nn.fromDom)}function yt(t,n){var e=t.dom().childNodes;return Bt.from(e[n]).map(nn.fromDom)}function Ct(t,n){pt(t).each((function(e){e.dom().insertBefore(n.dom(),t.dom())}))}function xt(t,n){bt(t).fold((function(){pt(t).each((function(t){Bn(t,n)}))}),(function(t){Ct(t,n)}))}function St(t,n){(function(t){return yt(t,0)})(t).fold((function(){Bn(t,n)}),(function(e){t.dom().insertBefore(n.dom(),e.dom())}))}function Rt(t,n){Ct(t,n),Bn(n,t)}function Tt(t,n){y(n,(function(e,r){xt(0===r?t:n[r-1],e)}))}function Ot(t,n){y(n,(function(n){Bn(t,n)}))}function Dt(t){t.dom().textContent="",y(wt(t),(function(t){In(t)}))}function At(t){var n=wt(t);0<n.length&&function(t,n){y(n,(function(n){Ct(t,n)}))}(t,n),In(t)}function Et(t,n,e){return function(t,n,e){return C(ht(t,e),n)}(t,(function(t){return dt(t,n)}),e)}function Nt(n,e){return function(n,e){var r=void 0===e?t.document:e.dom();return mt(r)?[]:w(r.querySelectorAll(n),nn.fromDom)}(e,n)}var Pt=function(t){function n(){return o}function e(n){return n(t)}var r=i(t),o={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:s,isNone:f,getOr:r,getOrThunk:r,getOrDie:r,getOrNull:r,getOrUndefined:r,or:n,orThunk:n,map:function(n){return Pt(n(t))},each:function(n){n(t)},bind:e,exists:e,forall:e,filter:function(n){return n(t)?o:d},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(f,(function(n){return e(t,n)}))}};return o},Bt={some:Pt,none:a,from:function(t){return null==t?d:Pt(t)}},It=tinymce.util.Tools.resolve("tinymce.PluginManager"),kt=h("string"),Mt=h("array"),Wt=h("boolean"),_t=h("function"),Lt=h("number"),jt=Array.prototype.slice,zt=Array.prototype.indexOf,Ht=Array.prototype.push,Ft=(_t(Array.from)&&Array.from,Object.keys),Ut=Object.hasOwnProperty,qt=function(t,n){var e={};return N(t,(function(t,r){var o=n(t,r);e[o.k]=o.v})),e},Vt=function(t,n){return Ut.call(t,n)},Gt=function(t,n){var e=t.concat(n);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return _("required",t),_("optional",n),L(e),function(r){var o=Ft(r);A(t,(function(t){return v(o,t)}))||M(t,o);var u=C(o,(function(t){return!v(e,t)}));0<u.length&&W(u);var c={};return y(t,(function(t){c[t]=i(r[t])})),y(n,(function(t){c[t]=i(Object.prototype.hasOwnProperty.call(r,t)?Bt.some(r[t]):Bt.none())})),c}},Yt=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),Kt=t.Node.DOCUMENT_NODE,Xt=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),$t=t.Node.TEXT_NODE,Jt=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,void 0!==t.window?t.window:Function("return this;")(),function(t){return t.dom().nodeName.toLowerCase()}),Qt=z(Xt),Zt=z($t),tn=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:i(t)}},nn={fromHtml:function(n,e){var r=(e||t.document).createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||1<r.childNodes.length)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return tn(r.childNodes[0])},fromTag:function(n,e){var r=(e||t.document).createElement(n);return tn(r)},fromText:function(n,e){var r=(e||t.document).createTextNode(n);return tn(r)},fromDom:tn,fromPoint:function(t,n,e){var r=t.dom();return Bt.from(r.elementFromPoint(n,e)).map(tn)}},en=Z((function(){return rn(nn.fromDom(t.document))})),rn=function(t){var n=t.dom().body;if(null==n)throw new Error("Body is not available yet");return nn.fromDom(n)},on=function(t,n){return Q(t)?t.style.getPropertyValue(n):""},un=function(){return(un=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},cn=function(){return an(0,0)},an=function(t,n){return{major:t,minor:n}},ln=function(t,n){var e=String(n).toLowerCase();return 0===t.length?cn():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var r=t[e];if(r.test(n))return r}}(t,n);if(!e)return{major:0,minor:0};function r(t){return Number(n.replace(e,"$"+t))}return an(r(1),r(2))}(t,e)},fn=cn,sn="Firefox",dn=function(t){var n=t.current;return{current:n,version:t.version,isEdge:ct("Edge",n),isChrome:ct("Chrome",n),isIE:ct("IE",n),isOpera:ct("Opera",n),isFirefox:ct(sn,n),isSafari:ct("Safari",n)}},mn=function(){return dn({current:void 0,version:fn()})},gn=dn,pn=(i("Edge"),i("Chrome"),i("IE"),i("Opera"),i(sn),i("Safari"),"Windows"),hn="Android",vn="Solaris",bn="FreeBSD",wn=function(t){var n=t.current;return{current:n,version:t.version,isWindows:at(pn,n),isiOS:at("iOS",n),isAndroid:at(hn,n),isOSX:at("OSX",n),isLinux:at("Linux",n),isSolaris:at(vn,n),isFreeBSD:at(bn,n)}},yn=function(){return wn({current:void 0,version:fn()})},Cn=wn,xn=(i(pn),i("iOS"),i(hn),i("Linux"),i("OSX"),i(vn),i(bn),/.*?version\/\ ?([0-9]+)\.([0-9]+).*/),Sn=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return $(t,"edge/")&&$(t,"chrome")&&$(t,"safari")&&$(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xn],search:function(t){return $(t,"chrome")&&!$(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return $(t,"msie")||$(t,"trident")}},{name:"Opera",versionRegexes:[xn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ft("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ft("firefox")},{name:"Safari",versionRegexes:[xn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return($(t,"safari")||$(t,"mobile/"))&&$(t,"applewebkit")}}],Rn=[{name:"Windows",search:ft("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return $(t,"iphone")||$(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ft("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ft("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ft("linux"),versionRegexes:[]},{name:"Solaris",search:ft("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ft("freebsd"),versionRegexes:[]}],Tn={browsers:i(Sn),oses:i(Rn)},On=e(function(n){var e=Tn.browsers(),r=Tn.oses(),o=function(t,n){return lt(t,n).map((function(t){var e=ln(t.versionRegexes,n);return{current:t.name,version:e}}))}(e,n).fold(mn,gn),u=function(t,n){return lt(t,n).map((function(t){var e=ln(t.versionRegexes,n);return{current:t.name,version:e}}))}(r,n).fold(yn,Cn);return{browser:o,os:u,deviceType:function(t,n,e,r){var o=t.isiOS()&&!0===/ipad/i.test(e),u=t.isiOS()&&!o,c=t.isiOS()||t.isAndroid(),a=c||r("(pointer:coarse)"),l=o||!u&&c&&r("(min-device-width:768px)"),f=u||c&&!l,s=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),d=!f&&!l&&!s;return{isiPad:i(o),isiPhone:i(u),isTablet:i(l),isPhone:i(f),isTouch:i(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:i(s),isDesktop:i(d)}}(u,o,n,(function(n){return t.window.matchMedia(n).matches}))}}(t.navigator.userAgent)),Dn=Xt,An=Kt,En=function(t,n){return t.dom()===n.dom()},Nn=st().browser.isIE()?function(n,e){return function(n,e){return function(t,n,e){return!!(t.compareDocumentPosition(n)&e)}(n,e,t.Node.DOCUMENT_POSITION_CONTAINED_BY)}(n.dom(),e.dom())}:function(t,n){var e=t.dom(),r=n.dom();return e!==r&&e.contains(r)},Pn=dt,Bn=(I("element","offset"),function(t,n){t.dom().appendChild(n.dom())}),In=function(t){var n=t.dom();null!==n.parentNode&&n.parentNode.removeChild(n)},kn=(I("width","height"),I("width","height"),I("rows","columns")),Mn=I("row","column"),Wn=(I("x","y"),I("element","rowspan","colspan")),_n=I("element","rowspan","colspan","isNew"),Ln=I("element","rowspan","colspan","row","column"),jn=I("element","cells","section"),zn=I("element","isNew"),Hn=I("element","cells","section","isNew"),Fn=I("cells","section"),Un=I("details","section"),qn=I("startRow","startCol","finishRow","finishCol"),Vn=function(t,n){var e=[];return y(wt(t),(function(t){n(t)&&(e=e.concat([t])),e=e.concat(Vn(t,n))})),e};function Gn(t,n,e,r,o){return t(e,r)?Bt.some(e):_t(o)&&o(e)?Bt.none():n(e,r,o)}function Yn(t,n,e){for(var r=t.dom(),o=_t(e)?e:i(!1);r.parentNode;){r=r.parentNode;var u=nn.fromDom(r);if(n(u))return Bt.some(u);if(o(u))break}return Bt.none()}function Kn(t,n,e){return Yn(t,(function(t){return dt(t,n)}),e)}function Xn(t,n){return function(t,n){return R(t.dom().childNodes,(function(t){return n(nn.fromDom(t))})).map(nn.fromDom)}(t,(function(t){return dt(t,n)}))}function $n(n,e){return function(n,e){var r=void 0===e?t.document:e.dom();return mt(r)?Bt.none():Bt.from(r.querySelector(n)).map(nn.fromDom)}(e,n)}function Jn(t,n,e){return Gn(dt,Kn,t,n,e)}function Qn(t,n){return pt(n).map((function(n){return function(t,n){return function(t,n){return C(wt(t),n)}(t,(function(t){return dt(t,n)}))}(n,t)}))}function Zn(t,n){return t+","+n}var te=function(t,n,e){return D(wt(t),(function(t){return dt(t,n)?e(t)?[t]:[]:te(t,n,e)}))},ne={firstLayer:function(t,n){return te(t,n,i(!0))},filterFirstLayer:te},ee=(u(Qn,"th,td"),u(Qn,"tr"),function(t,n){return function(t,n,e){return void 0===e&&(e=f),e(n)?Bt.none():v(t,Jt(n))?Bt.some(n):Kn(n,t.join(","),(function(t){return dt(t,"table")||e(t)}))}(["td","th"],t,n)}),re=function(t){return ne.firstLayer(t,"th,td")},oe=function(t,n){return Jn(t,"table",n)},ie=function(t){return w(function(t){return ne.firstLayer(t,"tr")}(t),(function(t){var n=t,e=pt(n).map((function(t){var n=Jt(t);return"tfoot"===n||"thead"===n||"tbody"===n?n:"tbody"})).getOr("tbody"),r=w(re(t),(function(t){var n=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,e=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return Wn(t,n,e)}));return jn(n,r,e)}))},ue=function(t,n){return C(D(t.all(),(function(t){return t.cells()})),n)},ce=function(t){var n={},e=[],r=t.length,o=0;y(t,(function(t,r){var i=[];y(t.cells(),(function(t){for(var e=0;void 0!==n[Zn(r,e)];)e++;for(var u=Ln(t.element(),t.rowspan(),t.colspan(),r,e),c=0;c<t.colspan();c++)for(var a=0;a<t.rowspan();a++){var l=e+c,f=Zn(r+a,l);n[f]=u,o=Math.max(o,l+1)}i.push(u)})),e.push(jn(t.element(),i,t.section()))}));var u=kn(r,o);return{grid:i(u),access:i(n),all:i(e)}},ae=function(t,n,e){var r=t.access()[Zn(n,e)];return void 0!==r?Bt.some(r):Bt.none()},le=function(t,n,e){var r=ue(t,(function(t){return e(n,t.element())}));return 0<r.length?Bt.some(r[0]):Bt.none()},fe=ue,se=function(t){return O(w(t.all(),(function(t){return t.cells()})))},de=I("minRow","minCol","maxRow","maxCol"),me=function(t,n){function e(t){return dt(t.element(),n)}var r=ie(t),o=ce(r),i=function(t,n){var e=t.grid().columns(),r=t.grid().rows(),o=e,i=0,u=0;return N(t.access(),(function(t){if(n(t)){var e=t.row(),c=e+t.rowspan()-1,a=t.column(),l=a+t.colspan()-1;e<r?r=e:i<c&&(i=c),a<o?o=a:u<l&&(u=l)}})),de(r,o,i,u)}(o,e),u="th:not("+n+"),td:not("+n+")",c=ne.filterFirstLayer(t,"th,td",(function(t){return dt(t,u)}));return y(c,In),function(t,n,e,r){for(var o,i,u,c=n.grid().columns(),a=n.grid().rows(),l=0;l<a;l++)for(var f=!1,s=0;s<c;s++)l<e.minRow()||l>e.maxRow()||s<e.minCol()||s>e.maxCol()||(ae(n,l,s).filter(r).isNone()?(o=f,i=t[l].element(),u=nn.fromTag("td"),Bn(u,nn.fromTag("br")),(o?Bn:St)(i,u)):f=!0)}(r,o,i,e),function(t,n){var e=C(ne.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));y(e,In),n.minCol()!==n.maxCol()&&n.minRow()!==n.maxRow()||y(ne.firstLayer(t,"th,td"),(function(t){Y(t,"rowspan"),Y(t,"colspan")})),Y(t,"width"),Y(t,"height"),ut(t,"width"),ut(t,"height")}(t,i),t};function ge(t){return Ne.get(t)}function pe(t){return Ne.getOption(t)}function he(t,n){Ne.set(t,n)}function ve(t){return"img"===Jt(t)?1:pe(t).fold((function(){return wt(t).length}),(function(t){return t.length}))}function be(t){return function(t){return pe(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf(" ")})).isSome()}(t)||v(Pe,Jt(t))}function we(t){return function(t,n){var e=function(t){for(var r=0;r<t.childNodes.length;r++){var o=nn.fromDom(t.childNodes[r]);if(n(o))return Bt.some(o);var i=e(t.childNodes[r]);if(i.isSome())return i}return Bt.none()};return e(t.dom())}(t,be)}function ye(t){return Be(t,be)}function Ce(t,n){return nn.fromDom(t.dom().cloneNode(n))}function xe(t){return Ce(t,!1)}function Se(t){return Ce(t,!0)}function Re(){var t=nn.fromTag("td");return Bn(t,nn.fromTag("br")),t}function Te(t,n,e){var r=function(t,n){var e=function(t,n){var e=nn.fromTag(n);return q(e,K(t)),e}(t,n);return Ot(e,wt(Se(t))),e}(t,n);return N(e,(function(t,n){null===t?Y(r,n):U(r,n,t)})),r}function Oe(t){return t}function De(t){return function(){return nn.fromTag("tr",t.dom())}}function Ae(t,n){return n.column()>=t.startCol()&&n.column()+n.colspan()-1<=t.finishCol()&&n.row()>=t.startRow()&&n.row()+n.rowspan()-1<=t.finishRow()}function Ee(t,n,e){var r=le(t,n,En),o=le(t,e,En);return r.bind((function(t){return o.map((function(n){return function(t,n){return qn(Math.min(t.row(),n.row()),Math.min(t.column(),n.column()),Math.max(t.row()+t.rowspan()-1,n.row()+n.rowspan()-1),Math.max(t.column()+t.colspan()-1,n.column()+n.colspan()-1))}(t,n)}))}))}var Ne=function(t){var n=function(n){return t(n)?Bt.from(n.dom().nodeValue):Bt.none()};return{get:function(e){if(!t(e))throw new Error("Can only get text value of a text node");return n(e).getOr("")},getOption:n,set:function(n,e){if(!t(n))throw new Error("Can only set raw text value of a text node");n.dom().nodeValue=e}}}(Zt),Pe=["img","br"],Be=function(t,n){var e=function(t){for(var r=wt(t),o=r.length-1;0<=o;o--){var i=r[o];if(n(i))return Bt.some(i);var u=e(i);if(u.isSome())return u}return Bt.none()};return e(t)},Ie=function(t,n,e){return{row:De(n),cell:function(n){var r=gt(n.element()),o=nn.fromTag(Jt(n.element()),r.dom()),i=e.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=0<i.length?function(t,n,e){return we(t).map((function(r){var o=Et(r,e.join(","),(function(n){return En(n,t)}));return x(o,(function(t,n){var e=xe(n);return Y(e,"contenteditable"),Bn(t,e),e}),n)})).getOr(n)}(n.element(),o,i):o;return Bn(u,nn.fromTag("br")),function(t,n){var e=t.dom(),r=n.dom();Q(e)&&Q(r)&&(r.style.cssText=e.style.cssText)}(n.element(),o),ut(o,"height"),1!==n.colspan()&&ut(n.element(),"width"),t(n.element(),o),o},replace:Te,gap:Re}},ke=function(t){return{row:De(t),cell:Re,replace:Oe,gap:Re}},Me=function(t,n){var e=n.column(),r=n.column()+n.colspan()-1,o=n.row(),i=n.row()+n.rowspan()-1;return e<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},We=Ee,_e=function(t,n,e){return We(t,n,e).map((function(n){return w(fe(t,u(Me,n)),(function(t){return t.element()}))}))},Le=function(t,n){return le(t,n,(function(t,n){return Nn(n,t)})).map((function(t){return t.element()}))},je=function(t){var n=ie(t);return ce(n)},ze=function(t,n,e){var r=je(t);return _e(r,n,e)},He=function(t,n,e,r,o){var i=je(t),u=En(t,e)?Bt.some(n):Le(i,n),c=En(t,o)?Bt.some(r):Le(i,r);return u.bind((function(t){return c.bind((function(n){return _e(i,t,n)}))}))},Fe=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Ue(){return{up:i({selector:Kn,closest:Jn,predicate:Yn,all:ht}),down:i({selector:Nt,predicate:Vn}),styles:i({get:ot,getRaw:it,set:et,remove:ut}),attrs:i({get:V,set:U,remove:Y,copyTo:function(t,n){q(n,K(t))}}),insert:i({before:Ct,after:xt,afterAll:Tt,append:Bn,appendAll:Ot,prepend:St,wrap:Rt}),remove:i({unwrap:At,remove:In}),create:i({nu:nn.fromTag,clone:function(t){return nn.fromDom(t.dom().cloneNode(!1))},text:nn.fromText}),query:i({comparePosition:function(t,n){return t.dom().compareDocumentPosition(n.dom())},prevSibling:vt,nextSibling:bt}),property:i({children:wt,name:Jt,parent:pt,document:function(t){return t.dom().ownerDocument},isText:Zt,isComment:H,isElement:Qt,getText:ge,setText:he,isBoundary:function(t){return!!Qt(t)&&("body"===Jt(t)||v(Fe,Jt(t)))},isEmptyTag:function(t){return!!Qt(t)&&v(["br","img","hr","input"],Jt(t))}}),eq:En,is:Pn}}function qe(t,n,e){var r=t.property().children(n);return T(r,u(t.eq,e)).map((function(t){return{before:i(r.slice(0,t)),after:i(r.slice(t+1))}}))}function Ve(t,n){return u(t.eq,n)}function Ge(t,n,e,r){function o(t){return T(t,r).fold((function(){return t}),(function(n){return t.slice(0,n+1)}))}void 0===r&&(r=f);var u=[n].concat(t.up().all(n)),c=[e].concat(t.up().all(e)),a=o(u),l=o(c),s=R(a,(function(n){return b(l,Ve(t,n))}));return{firstpath:i(a),secondpath:i(l),shared:i(s)}}function Ye(t){return Kn(t,"table")}function Ke(t,n,e){function r(t){return function(n){return void 0!==e&&e(n)||En(n,t)}}return En(t,n)?Bt.some(or.create({boxes:Bt.some([t]),start:t,finish:n})):Ye(t).bind((function(o){return Ye(n).bind((function(i){if(En(o,i))return Bt.some(or.create({boxes:ze(o,t,n),start:t,finish:n}));if(Nn(o,i)){var u=0<(c=Et(n,"td,th",r(o))).length?c[c.length-1]:n;return Bt.some(or.create({boxes:He(o,t,o,n,i),start:t,finish:u}))}if(Nn(i,o)){var c,a=0<(c=Et(t,"td,th",r(i))).length?c[c.length-1]:t;return Bt.some(or.create({boxes:He(i,t,o,n,i),start:t,finish:a}))}return rr.ancestors(t,n).shared().bind((function(u){return Jn(u,"table",e).bind((function(e){var u=Et(n,"td,th",r(e)),c=0<u.length?u[u.length-1]:n,a=Et(t,"td,th",r(e)),l=0<a.length?a[a.length-1]:t;return Bt.some(or.create({boxes:He(e,t,o,n,i),start:l,finish:c}))}))}))}))}))}function Xe(t,e){return dr.cata(e.get(),i([]),n,i([t]))}function $e(t){return{element:i(t),mergable:Bt.none,unmergable:Bt.none,selection:i([t])}}var Je=I("left","right"),Qe=I("first","second","splits"),Ze=function(t,n,e,r){return x(r,(function(e,r){var o=n(t,r);return tr(t,e,o)}),n(t,e))},tr=function(t,n,e){return n.bind((function(n){return e.filter(u(t.eq,n))}))},nr={sharedOne:function(t,n,e){return 0<e.length?function(t,n,e,r){return r(t,n,e[0],e.slice(1))}(t,n,e,Ze):Bt.none()},subset:function(t,n,e){var r=Ge(t,n,e);return r.shared().bind((function(n){return function(t,n,e,r){var o=t.property().children(n);if(t.eq(n,e[0]))return Bt.some([e[0]]);if(t.eq(n,r[0]))return Bt.some([r[0]]);function i(e){var r=E(e),i=T(r,Ve(t,n)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return T(o,Ve(t,u))}var u=i(e),c=i(r);return u.bind((function(t){return c.map((function(n){var e=Math.min(t,n),r=Math.max(t,n);return o.slice(e,r+1)}))}))}(t,n,r.firstpath(),r.secondpath())}))},ancestors:Ge,breakToLeft:function(t,n,e){return qe(t,n,e).map((function(r){var o=t.create().clone(n);return t.insert().appendAll(o,r.before().concat([e])),t.insert().appendAll(n,r.after()),t.insert().before(n,o),Je(o,n)}))},breakToRight:function(t,n,e){return qe(t,n,e).map((function(e){var r=t.create().clone(n);return t.insert().appendAll(r,e.after()),t.insert().after(n,r),Je(n,r)}))},breakPath:function(t,n,e,r){var o=function(n,i,u){var c=Qe(n,Bt.none(),u);return e(n)?Qe(n,i,u):t.property().parent(n).bind((function(i){return r(t,i,n).map((function(t){var n=[{first:t.left,second:t.right}],r=e(i)?i:t.left();return o(r,Bt.some(t.right()),u.concat(n))}))})).getOr(c)};return o(n,Bt.none(),[])}},er=Ue(),rr={sharedOne:function(t,n){return nr.sharedOne(er,(function(n,e){return t(e)}),n)},subset:function(t,n){return nr.subset(er,t,n)},ancestors:function(t,n,e){return nr.ancestors(er,t,n,e)},breakToLeft:function(t,n){return nr.breakToLeft(er,t,n)},breakToRight:function(t,n){return nr.breakToRight(er,t,n)},breakPath:function(t,n,e){return nr.breakPath(er,t,n,(function(t,n,r){return e(n,r)}))}},or={create:Gt(["boxes","start","finish"],[])},ir=Ke,ur=function(t,n){var e=Nt(t,n);return 0<e.length?Bt.some(e):Bt.none()},cr=function(t,n,e){return $n(t,n).bind((function(n){return $n(t,e).bind((function(t){return rr.sharedOne(Ye,[n,t]).map((function(e){return{first:i(n),last:i(t),table:i(e)}}))}))}))},ar=function(t,n,e){return cr(t,n,e).bind((function(n){function e(n){return En(t,n)}var r=Kn(n.first(),"thead,tfoot,tbody,table",e),o=Kn(n.last(),"thead,tfoot,tbody,table",e);return r.bind((function(t){return o.bind((function(e){return En(t,e)?function(t,n,e){return function(t,n,e){return Ee(t,n,e).bind((function(n){return function(t,n){for(var e=!0,r=u(Ae,n),o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)e=e&&ae(t,o,i).exists(r);return e?Bt.some(n):Bt.none()}(t,n)}))}(je(t),n,e)}(n.table(),n.first(),n.last()):Bt.none()}))}))}))},lr={selected:i("data-mce-selected"),selectedSelector:i("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:i("[data-mce-selected]"),firstSelected:i("data-mce-first-selected"),firstSelectedSelector:i("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:i("data-mce-last-selected"),lastSelectedSelector:i("td[data-mce-last-selected],th[data-mce-last-selected]")},fr=function(n){if(!Mt(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],r={};return y(n,(function(o,i){var u=Ft(o);if(1!==u.length)throw new Error("one and only one name per case");var c=u[0],a=o[c];if(void 0!==r[c])throw new Error("duplicate key detected:"+c);if("cata"===c)throw new Error("cannot have a case named cata (sorry)");if(!Mt(a))throw new Error("case arguments must be an array");e.push(c),r[c]=function(){var r=arguments.length;if(r!==a.length)throw new Error("Wrong number of arguments to case "+c+". Expected "+a.length+" ("+a+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);return arguments[i].apply(null,o)},match:function(t){var n=Ft(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!A(e,(function(t){return v(n,t)})))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[c].apply(null,o)},log:function(n){t.console.log(n,{constructors:e,constructor:c,params:o})}}}})),r},sr=fr([{none:[]},{multiple:["elements"]},{single:["selection"]}]),dr={cata:function(t,n,e,r){return t.fold(n,e,r)},none:sr.none,multiple:sr.multiple,single:sr.single},mr=function(t,n){return dr.cata(n.get(),Bt.none,(function(n,e){return 0===n.length?Bt.none():ar(t,lr.firstSelectedSelector(),lr.lastSelectedSelector()).bind((function(t){return 1<n.length?Bt.some({bounds:i(t),cells:i(n)}):Bt.none()}))}),Bt.none)},gr=function(t,n){var e=Xe(t,n);return 0<e.length&&A(e,(function(t){return G(t,"rowspan")&&1<parseInt(V(t,"rowspan"),10)||G(t,"colspan")&&1<parseInt(V(t,"colspan"),10)}))?Bt.some(e):Bt.none()},pr=Xe,hr={noMenu:$e,forMenu:function(t,n,e){return{element:i(e),mergable:i(mr(n,t)),unmergable:i(gr(e,t)),selection:i(pr(e,t))}},notCell:function(t){return $e(t)},paste:I("element","clipboard","generators"),pasteRows:function(t,n,e,r,o){return{element:i(e),mergable:Bt.none,unmergable:Bt.none,selection:i(pr(e,t)),clipboard:i(r),generators:i(o)}}};function vr(t,n){function e(e){var r=n(e);if(r<=0||null===r){var o=ot(e,t);return parseFloat(o)||0}return r}function r(t,n){return S(n,(function(n,e){var r=ot(t,e),o=void 0===r?0:parseInt(r,10);return isNaN(o)?n:n+o}),0)}return{set:function(n,e){if(!Lt(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var r=n.dom();Q(r)&&(r.style[t]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(t,n,e){var o=r(t,e);return o<n?n-o:0}}}function br(t){return _r.get(t)}function wr(t){return _r.getOuter(t)}function yr(t){return Lr.get(t)}function Cr(t){return Lr.getOuter(t)}function xr(t,n,e){return function(t,n){var e=parseFloat(t);return isNaN(e)?n:e}(ot(t,n),e)}function Sr(t,n){et(t,"height",n+"px")}function Rr(t){var n=function(t){return it(t,"height").getOrThunk((function(){return zr(t)+"px"}))}(t);return n?function(t,n,e,r){var o=parseInt(t,10);return function(t){return X(t,"%",t.length-1)}(t)&&"table"!==Jt(n)?function(t,n,e,r){var o=oe(t).map((function(t){var r=e(t);return Math.floor(n/100*r)})).getOr(n);return r(t,o),o}(n,o,e,r):o}(n,t,br,Sr):br(t)}function Tr(t){return it(t,"width").fold((function(){return Bt.from(V(t,"width"))}),(function(t){return Bt.some(t)}))}function Or(t,n){return t/n.pixelWidth()*100}function Dr(t,n){return void 0!==t?t:void 0!==n?n:0}function Ar(t){var n=t.dom().ownerDocument,e=n.body,r=n.defaultView,o=n.documentElement;if(e===t.dom())return Yr(e.offsetLeft,e.offsetTop);var i=Dr(r.pageYOffset,o.scrollTop),u=Dr(r.pageXOffset,o.scrollLeft),c=Dr(o.clientTop,e.clientTop),a=Dr(o.clientLeft,e.clientLeft);return Kr(t).translate(u-a,i-c)}function Er(t){return Ar(t).left()+Cr(t)}function Nr(t){return Ar(t).left()}function Pr(t,n){return $r(t,Nr(n))}function Br(t,n){return $r(t,Er(n))}function Ir(t){return Ar(t).top()}function kr(t,n){return Xr(t,Ir(n))}function Mr(t,n){return Xr(t,Ir(n)+wr(n))}function Wr(t,n,e){if(0===e.length)return[];var r=w(e.slice(1),(function(n,e){return n.map((function(n){return t(e,n)}))})),o=e[e.length-1].map((function(t){return n(e.length-1,t)}));return r.concat([o])}var _r=vr("height",(function(t){var n=t.dom();return tt(t)?n.getBoundingClientRect().height:n.offsetHeight})),Lr=vr("width",(function(t){return t.dom().offsetWidth})),jr=st(),zr=function(t){return jr.browser.isIE()||jr.browser.isEdge()?function(t){var n=xr(t,"padding-top",0),e=xr(t,"padding-bottom",0),r=xr(t,"border-top-width",0),o=xr(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height;return"border-box"===ot(t,"box-sizing")?i:i-n-e-(r+o)}(t):xr(t,"height",br(t))},Hr=/(\d+(\.\d+)?)(\w|%)*/,Fr=/(\d+(\.\d+)?)%/,Ur=/(\d+(\.\d+)?)px|em/,qr={percentageBasedSizeRegex:i(Fr),pixelBasedSizeRegex:i(Ur),setPixelWidth:function(t,n){et(t,"width",n+"px")},setPercentageWidth:function(t,n){et(t,"width",n+"%")},setHeight:Sr,getPixelWidth:function(t,n){return Tr(t).fold((function(){return yr(t)}),(function(e){return function(t,n,e){var r=Ur.exec(n);if(null!==r)return parseInt(r[1],10);var o=Fr.exec(n);return null===o?yr(t):function(t,n){return t/100*n.pixelWidth()}(parseFloat(o[1]),e)}(t,e,n)}))},getPercentageWidth:function(t,n){return Tr(t).fold((function(){return Or(yr(t),n)}),(function(e){return function(t,n,e){var r=Fr.exec(n);return null!==r?parseFloat(r[1]):Or(yr(t),e)}(t,e,n)}))},getGenericWidth:function(t){return Tr(t).bind((function(t){var n=Hr.exec(t);return null!==n?Bt.some({width:i(parseFloat(n[1])),unit:i(n[3])}):Bt.none()}))},setGenericWidth:function(t,n,e){et(t,"width",n+e)},getHeight:function(t){return function(t,n,e){return e(t)/function(t,n){return G(t,n)?parseInt(V(t,n),10):1}(t,"rowspan")}(t,0,Rr)},getRawWidth:Tr},Vr=function(t,n){qr.getGenericWidth(t).each((function(e){var r=e.width()/2;qr.setGenericWidth(t,r,e.unit()),qr.setGenericWidth(n,r,e.unit())}))},Gr=function(t,n){return{left:i(t),top:i(n),translate:function(e,r){return Gr(t+e,n+r)}}},Yr=Gr,Kr=function(t){var n=t.dom(),e=n.ownerDocument.body;return e===n?Yr(e.offsetLeft,e.offsetTop):tt(t)?function(t){var n=t.getBoundingClientRect();return Yr(n.left,n.top)}(n):Yr(0,0)},Xr=I("row","y"),$r=I("col","x"),Jr={height:{delta:n,positions:function(t){return Wr(kr,Mr,t)},edge:Ir},rtl:{delta:function(t){return-t},edge:Er,positions:function(t){return Wr(Br,Pr,t)}},ltr:{delta:n,edge:Nr,positions:function(t){return Wr(Pr,Br,t)}}},Qr={ltr:Jr.ltr,rtl:Jr.rtl};function Zr(t){function n(n){return t(n).isRtl()?Qr.rtl:Qr.ltr}return{delta:function(t,e){return n(e).delta(t,e)},edge:function(t){return n(t).edge(t)},positions:function(t,e){return n(e).positions(t,e)}}}function to(t){for(var n=[],e=function(t){n.push(t)},r=0;r<t.length;r++)t[r].each(e);return n}function no(t,n){for(var e=0;e<t.length;e++){var r=n(t[e],e);if(r.isSome())return r}return Bt.none()}function eo(t,n,e,r){e===r?Y(t,n):U(t,n,e)}function ro(t){return void 0!==t.dom().classList}function oo(t,n){ro(t)?t.dom().classList.add(n):function(t,n){!function(t,n,e){U(t,n,function(t,n){var e=V(t,n);return void 0===e||""===e?[]:e.split(" ")}(t,n).concat([e]).join(" "))}(t,"class",n)}(t,n)}function io(t,n){return ro(t)&&t.dom().classList.contains(n)}function uo(t,n){for(var e=[],r=t;r<n;r++)e.push(r);return e}function co(t,n){if(n<0||n>=t.length-1)return Bt.none();var e=t[n].fold((function(){return no(E(t.slice(0,n)),(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return Bt.some({value:t,delta:0})})),r=t[n+1].fold((function(){return no(t.slice(n+1),(function(t,n){return t.map((function(t){return{value:t,delta:n+1}}))}))}),(function(t){return Bt.some({value:t,delta:1})}));return e.bind((function(t){return r.map((function(n){var e=n.delta+t.delta;return Math.abs(n.value-t.value)/e}))}))}function ao(t){var n=t.replace(/\./g,"-");return{resolve:function(t){return n+"-"+t}}}function lo(t){y(Nt(t.parent(),"."+Ai),In)}function fo(t,n,e){var r=t.origin();y(n,(function(n,o){n.each((function(n){var o=e(r,n);oo(o,Ai),Bn(t.parent(),o)}))}))}function so(t,n){y(Nt(t.parent(),"."+Ai),n)}function mo(t,n){return t.cells()[n]}function go(t,n){if(0===t.length)return 0;var e=t[0];return T(t,(function(t){return!n(e.element(),t.element())})).fold((function(){return t.length}),(function(t){return t}))}function po(t,n){return function(t,n){return w(t,(function(t){var e=function(t){return no(t,(function(t){return pt(t.element()).map((function(t){var n=pt(t).isNone();return zn(t,n)}))})).getOrThunk((function(){return zn(n.row(),!0)}))}(t.details());return Hn(e.element(),t.details(),t.section(),e.isNew())}))}(_i(t,En),n)}function ho(t,n){return R(O(w(t.all(),(function(t){return t.cells()}))),(function(t){return En(n,t.element())}))}function vo(t,n,e,r,o){return function(u,c,a,l,f){var s=ie(c),d=ce(s);return n(d,a).map((function(n){var e=function(t,n){return Li(t,n,!1)}(d,l),r=t(e,n,En,o(l)),u=po(r.grid(),l);return{grid:i(u),cursor:r.cursor}})).fold((function(){return Bt.none()}),(function(t){var n=Si(c,t.grid());return e(c,t.grid(),f),r(c),Pi(u,c,Jr.height,f),Bt.some({cursor:t.cursor,newRows:n.newRows,newCells:n.newCells})}))}}function bo(t,n){return ee(n.element()).bind((function(n){return ho(t,n)}))}function wo(t,n){var e=to(w(n.selection(),(function(n){return ee(n).bind((function(n){return ho(t,n)}))})));return 0<e.length?Bt.some({cells:e,generators:n.generators,clipboard:n.clipboard}):Bt.none()}function yo(t,n){var e=to(w(n.selection(),(function(n){return ee(n).bind((function(n){return ho(t,n)}))})));return 0<e.length?Bt.some(e):Bt.none()}function Co(t,n){return w(t,(function(){return zn(n.cell(),!0)}))}function xo(t,n,e){return t.concat(function(t,n){for(var e=[],r=0;r<t;r++)e.push(n());return e}(n,(function(n){return Wi.setCells(t[t.length-1],Co(t[t.length-1].cells(),e))})))}function So(t,n,e){return w(t,(function(t){return Wi.setCells(t,t.cells().concat(Co(uo(0,n),e)))}))}function Ro(t,n,e,r){return w(t,(function(t){return Wi.mapCells(t,(function(t){return function(t){return b(n,(function(n){return e(t.element(),n.element())}))}(t)?zn(r(t.element(),e),!0):t}))}))}function To(t,n,e,r){return void 0!==Wi.getCellElement(t[n],e)&&0<n&&r(Wi.getCellElement(t[n-1],e),Wi.getCellElement(t[n],e))}function Oo(t,n,e){return 0<n&&e(Wi.getCellElement(t,n-1),Wi.getCellElement(t,n))}function Do(t,n){return G(t,n)&&1<parseInt(V(t,n),10)}function Ao(t,n,e){return it(t,n).fold((function(){return e(t)+"px"}),(function(t){return t}))}function Eo(t,n){return Ao(t,"width",(function(t){return qr.getPixelWidth(t,n)}))}function No(t){return Ao(t,"height",qr.getHeight)}function Po(t,n,e,r,o){var i=Ti(t),u=w(i,(function(t){return t.map(n.edge)}));return w(i,(function(t,n){return t.filter(c(Qi.hasColspan)).fold((function(){var t=co(u,n);return r(t)}),(function(t){return e(t,o)}))}))}function Bo(t){return t.map((function(t){return t+"px"})).getOr("")}function Io(t,n,e,r){var o=Oi(t),i=w(o,(function(t){return t.map(n.edge)}));return w(o,(function(t,n){return t.filter(c(Qi.hasRowspan)).fold((function(){var t=co(i,n);return r(t)}),(function(t){return e(t)}))}))}function ko(t,n,e){for(var r=0,o=t;o<n;o++)r+=void 0!==e[o]?e[o]:0;return r}function Mo(t){var e=n;return{width:i(t),pixelWidth:i(t),getWidths:Zi.getPixelWidths,getCellDelta:e,singleColumnWidth:function(t,n){return[Math.max(Qi.minWidth(),t+n)-t]},minCellWidth:Qi.minWidth,setElementWidth:qr.setPixelWidth,setTableWidth:function(t,n,e){var r=x(n,(function(t,n){return t+n}),0);qr.setPixelWidth(t,r)}}}function Wo(t){return ce(t)}function _o(t){return Wo(ie(t))}function Lo(t,n){var e=C(n,(function(n){return!v(t,n)}));0<e.length&&W(e)}function jo(t){return function(t,n){return eu(t,n,{validate:_t,label:"function"})}(Lo,t)}function zo(t){var n=G(t,"colspan")?parseInt(V(t,"colspan"),10):1,e=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1;return{element:i(t),colspan:i(n),rowspan:i(e)}}function Ho(t){0===re(t).length&&In(t)}function Fo(t,n,e){return mu(t,n,e).orThunk((function(){return mu(t,0,0)}))}function Uo(t,n,e){return du(t,mu(t,n,e))}function qo(t){return S(t,(function(t,n){return b(t,(function(t){return t.row()===n.row()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.row()-n.row()}))}function Vo(t){return S(t,(function(t,n){return b(t,(function(t){return t.column()===n.column()}))?t:t.concat([n])}),[]).sort((function(t,n){return t.column()-n.column()}))}function Go(t,n,e){var r=function(t,n){return w(t,(function(t){var e=w(re(t),(function(t){var n=G(t,"rowspan")?parseInt(V(t,"rowspan"),10):1,e=G(t,"colspan")?parseInt(V(t,"colspan"),10):1;return Wn(t,n,e)}));return jn(t,e,n.section())}))}(t,e),o=ce(r);return Li(o,n,!0)}function Yo(t){return t.getBoundingClientRect().width}function Ko(t){return t.getBoundingClientRect().height}function Xo(t){return/^[0-9]+$/.test(t)&&(t+="px"),t}function $o(t){var n=Nt(t,"td[data-mce-style],th[data-mce-style]");Y(t,"data-mce-style"),y(n,(function(t){Y(t,"data-mce-style")}))}function Jo(t){return t.getParam("table_default_attributes",xu,"object")}function Qo(t){return t.getParam("table_default_styles",Cu,"object")}function Zo(t){return t.getParam("table_cell_advtab",!0,"boolean")}function ti(t){return t.getParam("table_row_advtab",!0,"boolean")}function ni(t){return t.getParam("table_advtab",!0,"boolean")}function ei(t){return t.getParam("table_style_by_css",!1,"boolean")}function ri(t){return t.getParam("table_class_list",[],"array")}function oi(t){return!1===t.getParam("table_responsive_width")}function ii(t,n){return t.fire("newrow",{node:n})}function ui(t,n){return t.fire("newcell",{node:n})}function ci(t,n,e,r){t.fire("ObjectResizeStart",{target:n,width:e,height:r})}function ai(t,n,e,r){t.fire("ObjectResized",{target:n,width:e,height:r})}function li(t,n){function e(n){return J(n,"rgb")?t.toHex(n):n}return{borderwidth:it(nn.fromDom(n),"border-width").getOr(""),borderstyle:it(nn.fromDom(n),"border-style").getOr(""),bordercolor:it(nn.fromDom(n),"border-color").map(e).getOr(""),backgroundcolor:it(nn.fromDom(n),"background-color").map(e).getOr("")}}function fi(t,n,e,r,o){var i={};return Tu.each(t.split(" "),(function(t){r.formatter.matchNode(o,n+t)&&(i[e]=t)})),i[e]||(i[e]=""),i}function si(t,n){t.setAttrib("scope",n.scope),t.setAttrib("class",n.class),t.setStyle("width",Xo(n.width)),t.setStyle("height",Xo(n.height))}function di(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle),t.setStyle("border-width",Xo(n.borderwidth))}function mi(t,n,e){var r=t.dom,o=e.celltype&&n[0].nodeName.toLowerCase()!==e.celltype?r.rename(n[0],e.celltype):n[0],i=Lu.normal(r,o);si(i,e),Zo(t)&&di(i,e),Au(t,o),Eu(t,o),e.halign&&Ou(t,o,e.halign),e.valign&&Du(t,o,e.valign)}function gi(t,n,e){var r=t.dom;Tu.each(n,(function(n){e.celltype&&n.nodeName.toLowerCase()!==e.celltype&&(n=r.rename(n,e.celltype));var o=Lu.ifTruthy(r,n);si(o,e),Zo(t)&&di(o,e),e.halign&&Ou(t,n,e.halign),e.valign&&Du(t,n,e.valign)}))}function pi(t,n,e){var r=e.getData();e.close(),t.undoManager.transact((function(){(1===n.length?mi:gi)(t,n,r),t.focus()}))}function hi(t,n,e,r){var o=t.dom,i=r.getData();r.close();var u=1===n.length?Lu.normal:Lu.ifTruthy;t.undoManager.transact((function(){Tu.each(n,(function(n){i.type!==n.parentNode.nodeName.toLowerCase()&&function(t,n,e){var r=t.getParent(n,"table"),o=n.parentNode,i=t.select(e,r)[0];i||(i=t.create(e),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(n),o.hasChildNodes()||t.remove(o)}(t.dom,n,i.type);var r=u(o,n);r.setAttrib("scope",i.scope),r.setAttrib("class",i.class),r.setStyle("height",Xo(i.height)),ti(t)&&function(t,n){t.setStyle("background-color",n.backgroundcolor),t.setStyle("border-color",n.bordercolor),t.setStyle("border-style",n.borderstyle)}(r,i),i.align!==e.align&&(Au(t,n),Ou(t,n,i.align))})),t.focus()}))}function vi(t,n){t.selection.select(n.dom(),!0),t.selection.collapse(!0)}function bi(t,n,e){var r,o=t.dom,i=e.getData();e.close(),""===i.class&&delete i.class,t.undoManager.transact((function(){if(!n){var e=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;n=Yu(t,e,u)}!function(t,n,e){var r=t.dom,o={},i={};if(o.class=e.class,i.height=Xo(e.height),r.getAttrib(n,"width")&&!ei(t)?o.width=function(t){return t?t.replace(/px$/,""):""}(e.width):i.width=Xo(e.width),ei(t)?(i["border-width"]=Xo(e.border),i["border-spacing"]=Xo(e.cellspacing)):(o.border=e.border,o.cellpadding=e.cellpadding,o.cellspacing=e.cellspacing),ei(t)&&n.children)for(var u=0;u<n.children.length;u++)Xu(r,n.children[u],{"border-width":Xo(e.border),padding:Xo(e.cellpadding)}),ni(t)&&Xu(r,n.children[u],{"border-color":e.bordercolor});ni(t)&&(i["background-color"]=e.backgroundcolor,i["border-color"]=e.bordercolor,i["border-style"]=e.borderstyle),o.style=r.serializeStyle(qu(Qo(t),i)),r.setAttribs(n,qu(Jo(t),o))}(t,n,i),(r=o.select("caption",n)[0])&&!i.caption&&o.remove(r),!r&&i.caption&&((r=o.create("caption")).innerHTML=Vu.ie?" ":'<br data-mce-bogus="1"/>',n.insertBefore(r,n.firstChild)),""===i.align?Au(t,n):Ou(t,n,i.align),t.focus(),t.addVisual()}))}function wi(t){return function(n){return Bt.from(n.dom.getParent(n.selection.getStart(),t)).map(nn.fromDom)}}function yi(t,n,e){return function(t,n,e,r){return function(t,n,e,r,c){var a=function(t,n){return function(e){t(e)&&n(function(t){function n(){t.stopPropagation()}function e(){t.preventDefault()}var r=nn.fromDom(t.target),u=o(e,n);return function(t,n,e,r,o,u,c){return{target:i(t),x:i(n),y:i(e),stop:r,prevent:o,kill:u,raw:i(c)}}(r,t.clientX,t.clientY,n,e,u,t)}(e))}}(e,r);return t.dom().addEventListener(n,a,c),{unbind:u(oc,t,n,a,c)}}(t,n,e,r,!1)}(t,n,ic,e)}var Ci,xi=function(t){var n=ie(t);return ce(n).grid()},Si=function(t,n){function e(n,e){0<n.length?function(n,e){var i=Xn(t,e).getOrThunk((function(){var n=nn.fromTag(e,gt(t).dom());return Bn(t,n),n}));Dt(i);var u=w(n,(function(t){t.isNew()&&r.push(t.element());var n=t.element();return Dt(n),y(t.cells(),(function(t){t.isNew()&&o.push(t.element()),eo(t.element(),"colspan",t.colspan(),1),eo(t.element(),"rowspan",t.rowspan(),1),Bn(n,t.element())})),n}));Ot(i,u)}(n,e):function(n){Xn(t,n).each(In)}(e)}var r=[],o=[],u=[],c=[],a=[];return y(n,(function(t){switch(t.section()){case"thead":u.push(t);break;case"tbody":c.push(t);break;case"tfoot":a.push(t)}})),e(u,"thead"),e(c,"tbody"),e(a,"tfoot"),{newRows:i(r),newCells:i(o)}},Ri=function(t,n,e){var r=t();return R(r,n).orThunk((function(){return Bt.from(r[0]).orThunk(e)})).map((function(t){return t.element()}))},Ti=function(t){var n=t.grid(),e=uo(0,n.columns()),r=uo(0,n.rows());return w(e,(function(n){return Ri((function(){return D(r,(function(e){return ae(t,e,n).filter((function(t){return t.column()===n})).fold(i([]),(function(t){return[t]}))}))}),(function(t){return 1===t.colspan()}),(function(){return ae(t,0,n)}))}))},Oi=function(t){var n=t.grid(),e=uo(0,n.rows()),r=uo(0,n.columns());return w(e,(function(n){return Ri((function(){return D(r,(function(e){return ae(t,n,e).filter((function(t){return t.row()===n})).fold(i([]),(function(t){return[t]}))}))}),(function(t){return 1===t.rowspan()}),(function(){return ae(t,n,0)}))}))},Di={resolve:ao("ephox-snooker").resolve},Ai=Di.resolve("resizer-bar"),Ei=Di.resolve("resizer-rows"),Ni=Di.resolve("resizer-cols"),Pi=function(t,n,e,r){lo(t);var o=ie(n),i=ce(o);!function(t,n,e,r,o,i){var u=Ar(n);!function(t,n,e,r){fo(t,n,(function(t,n){var o=function(t,n,e,r,o){var i=nn.fromTag("div");return rt(i,{position:"absolute",left:n+"px",top:e-o/2+"px",height:o+"px",width:r+"px"}),q(i,{"data-row":t,role:"presentation"}),i}(n.row(),e.left()-t.left(),n.y()-t.top(),r,7);return oo(o,Ei),o}))}(t,0<e.length?o.positions(e,n):[],u,Cr(n)),function(t,n,e,r){fo(t,n,(function(t,n){var o=function(t,n,e,r,o){var i=nn.fromTag("div");return rt(i,{position:"absolute",left:n-r/2+"px",top:e+"px",height:o+"px",width:r+"px"}),q(i,{"data-column":t,role:"presentation"}),i}(n.col(),n.x()-t.left(),e.top()-t.top(),7,r);return oo(o,Ni),o}))}(t,0<r.length?i.positions(r,n):[],u,wr(n))}(t,n,Oi(i),Ti(i),e,r)},Bi=function(t){so(t,(function(t){et(t,"display","none")}))},Ii=function(t){so(t,(function(t){et(t,"display","block")}))},ki=lo,Mi=function(t,n){return Fn(n,t.section())},Wi={addCell:function(t,n,e){var r=t.cells(),o=r.slice(0,n),i=r.slice(n),u=o.concat([e]).concat(i);return Mi(t,u)},setCells:Mi,mutateCell:function(t,n,e){t.cells()[n]=e},getCell:mo,getCellElement:function(t,n){return mo(t,n).element()},mapCells:function(t,n){var e=w(t.cells(),n);return Fn(e,t.section())},cellLength:function(t){return t.cells().length}},_i=function(t,n){var e=w(t,(function(t,n){return w(t.cells(),(function(t,n){return!1}))}));return w(t,(function(r,o){var u=D(r.cells(),(function(r,u){if(!1!==e[o][u])return[];var c=function(t,n,e,r){var o=function(t,n){return t[n]}(t,n).cells().slice(e),u=go(o,r),c=function(t,n){return w(t,(function(t){return Wi.getCell(t,n)}))}(t,e).slice(n),a=go(c,r);return{colspan:i(u),rowspan:i(a)}}(t,o,u,n);return function(t,n,r,o){for(var i=t;i<t+r;i++)for(var u=n;u<n+o;u++)e[i][u]=!0}(o,u,c.rowspan(),c.colspan()),[_n(r.element(),c.rowspan(),c.colspan(),r.isNew())]}));return Un(u,r.section())}))},Li=function(t,n,e){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var c=ae(t,o,u).map((function(t){return zn(t.element(),e)})).getOrThunk((function(){return zn(n.gap(),!0)}));i.push(c)}var a=Fn(i,t.all()[o].section());r.push(a)}return r},ji=function(t){return{is:function(n){return t===n},isValue:s,isError:f,getOr:i(t),getOrThunk:i(t),getOrDie:i(t),or:function(n){return ji(t)},orThunk:function(n){return ji(t)},fold:function(n,e){return e(t)},map:function(n){return ji(n(t))},mapError:function(n){return ji(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return Bt.some(t)}}},zi=function(t){return{is:f,isValue:f,isError:s,getOr:n,getOrThunk:function(t){return t()},getOrDie:function(){return function(t){return function(){throw new Error(t)}}(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return zi(t)},mapError:function(n){return zi(n(t))},each:r,bind:function(n){return zi(t)},exists:f,forall:s,toOption:Bt.none}},Hi={value:ji,error:zi,fromOption:function(t,n){return t.fold((function(){return zi(n)}),ji)}},Fi=function(t,n){var e=Wi.cellLength(t[0]),r=Wi.cellLength(n[0]);return{rowDelta:i(0),colDelta:i(e-r)}},Ui=function(t,e,r){var o=e.colDelta()<0?So:n;return(e.rowDelta()<0?xo:n)(o(t,Math.abs(e.colDelta()),r),Math.abs(e.rowDelta()),r)},qi=function(t,n,e,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Wi.cellLength(t[0]);u++){var c=e(Wi.getCellElement(t[i],u),n);!0===c&&!1===o?Wi.mutateCell(t[i],u,zn(r(),!0)):!0===c&&(o=!1)}return t},Vi=function(t,n,e,r,o){!function(t,n,e,r){if(0<n&&n<t.length){var o=function(t,n){return S(t,(function(t,e){return b(t,(function(t){return n(t.element(),e.element())}))?t:t.concat([e])}),[])}(t[n-1].cells(),e);y(o,(function(o){for(var i=Bt.none(),u=function(n){for(var u=function(u){var c=t[n].cells()[u];e(c.element(),o.element())&&(i.isNone()&&(i=Bt.some(r())),i.each((function(e){Wi.mutateCell(t[n],u,zn(e,!0))})))},c=0;c<Wi.cellLength(t[0]);c++)u(c)},c=n;c<t.length;c++)u(c)}))}}(n,t,o,r.cell);var i=Fi(e,n),u=Ui(e,i,r),c=Fi(n,u),a=Ui(n,c,r);return a.slice(0,t).concat(u).concat(a.slice(t,a.length))},Gi=function(t,n,e,r,o){var i=t.slice(0,n),u=t.slice(n),c=Wi.mapCells(t[e],(function(e,i){return 0<n&&n<t.length&&r(Wi.getCellElement(t[n-1],i),Wi.getCellElement(t[n],i))?Wi.getCell(t[n],i):zn(o(e.element(),r),!0)}));return i.concat([c]).concat(u)},Yi=function(t,n,e,r,o){return w(t,(function(t){var i=0<n&&n<Wi.cellLength(t)&&r(Wi.getCellElement(t,n-1),Wi.getCellElement(t,n))?Wi.getCell(t,n):zn(o(Wi.getCellElement(t,e),r),!0);return Wi.addCell(t,n,i)}))},Ki=function(t,n,e,r){var o=D(t,(function(r,o){return To(t,o,n,e)||Oo(r,n,e)?[]:[Wi.getCell(r,n)]}));return Ro(t,o,e,r)},Xi=function(t,n,e,r){var o=t[n],i=D(o.cells(),(function(r,i){return To(t,n,i,e)||Oo(o,i,e)?[]:[r]}));return Ro(t,i,e,r)},$i=fr([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),Ji=un({},$i),Qi={hasColspan:function(t){return Do(t,"colspan")},hasRowspan:function(t){return Do(t,"rowspan")},minWidth:i(10),minHeight:i(10),getInt:function(t,n){return parseInt(ot(t,n),10)}},Zi={getRawWidths:function(t,n,e){return Po(t,n,Eo,Bo,e)},getPixelWidths:function(t,n,e){return Po(t,n,qr.getPixelWidth,(function(t){return t.getOrThunk(e.minCellWidth)}),e)},getPercentageWidths:function(t,n,e){return Po(t,n,qr.getPercentageWidth,(function(t){return t.fold((function(){return e.minCellWidth()}),(function(t){return t/e.pixelWidth()*100}))}),e)},getPixelHeights:function(t,n){return Io(t,n,qr.getHeight,(function(t){return t.getOrThunk(Qi.minHeight)}))},getRawHeights:function(t,n){return Io(t,n,No,Bo)}},tu=function(t,n){return w(se(t),(function(t){var e=ko(t.column(),t.column()+t.colspan(),n);return{element:t.element,width:i(e),colspan:t.colspan}}))},nu=function(t){return qr.getRawWidth(t).fold((function(){return Mo(yr(t))}),(function(n){return function(t,n){var e=qr.percentageBasedSizeRegex().exec(n);if(null!==e)return function(t,n){var e=parseFloat(t),r=yr(n);return{width:i(e),pixelWidth:i(r),getWidths:Zi.getPercentageWidths,getCellDelta:function(t){return t/r*100},singleColumnWidth:function(t,n){return[100-t]},minCellWidth:function(){return Qi.minWidth()/r*100},setElementWidth:qr.setPercentageWidth,setTableWidth:function(t,n,r){var o=r/100*e;qr.setPercentageWidth(t,e+o)}}}(e[1],t);var r=qr.pixelBasedSizeRegex().exec(n);return Mo(null!==r?parseInt(r[1],10):yr(t))}(t,n)}))},eu=function(t,n,e){if(0===n.length)throw new Error("You must specify at least one required field.");return _("required",n),L(n),function(r){var o=Ft(r);A(n,(function(t){return v(o,t)}))||M(n,o),t(n,o);var i=C(n,(function(t){return!e.validate(r[t],t)}));return 0<i.length&&function(t,n){throw new Error("All values need to be of type: "+n+". Keys ("+k(t).join(", ")+") were not.")}(i,e.label),r}},ru=jo(["cell","row","replace","gap"]),ou=function(t,n){function r(e){return function(n){return t.cell(n)}(n(e))}function o(t){var n=r(t);return i.get().isNone()&&i.set(Bt.some(n)),u=Bt.some({item:t,replacement:n}),n}void 0===n&&(n=zo),ru(t);var i=e(Bt.none()),u=Bt.none();return{getOrInit:function(t,n){return u.fold((function(){return o(t)}),(function(e){return n(t,e.item)?e.replacement:o(t)}))},cursor:i.get}},iu=function(t,n){return function(r){var o=e(Bt.none());function i(e){var i={scope:t},c=r.replace(e,n,i);return u.push({item:e,sub:c}),o.get().isNone()&&o.set(Bt.some(c)),c}ru(r);var u=[];return{replaceOrInit:function(t,n){return function(t,n){return R(u,(function(e){return n(e.item,t)}))}(t,n).fold((function(){return i(t)}),(function(e){return n(t,e.item)?e.sub:i(t)}))},cursor:o.get}}},uu=function(t){ru(t);var n=e(Bt.none());return{combine:function(e){return n.get().isNone()&&n.set(Bt.some(e)),function(){var n=t.cell({element:i(e),colspan:i(1),rowspan:i(1)});return ut(n,"width"),ut(e,"width"),n}},cursor:n.get}},cu=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],au=Ue(),lu=function(t){return function(t,n){var e=t.property().name(n);return v(cu,e)}(au,t)},fu=function(t){return function(t,n){return v(["ol","ul"],t.property().name(n))}(au,t)},su=function(t){function n(t){return"br"===Jt(t)}function e(t){return ye(t).bind((function(e){var r=function(t){return bt(t).map((function(t){return!!lu(t)||!!function(t){return function(t,n){return v(["br","img","hr","input"],t.property().name(n))}(au,t)}(t)&&"img"!==Jt(t)})).getOr(!1)}(e);return pt(e).map((function(o){return!0===r||function(t){return"li"===Jt(t)||Yn(t,fu).isSome()}(o)||n(e)||lu(o)&&!En(t,o)?[]:[nn.fromTag("br")]}))})).getOr([])}var r,o=0===(r=D(t,(function(t){var r=wt(t);return function(t){return A(t,(function(t){return n(t)||Zt(t)&&0===ge(t).trim().length}))}(r)?[]:r.concat(e(t))}))).length?[nn.fromTag("br")]:r;Dt(t[0]),Ot(t[0],o)},du=I("grid","cursor"),mu=function(t,n,e){return Bt.from(t[n]).bind((function(t){return Bt.from(t.cells()[e]).bind((function(t){return Bt.from(t.element())}))}))},gu=function(t,n,e){var r=nu(t),o=Wo(n),i=r.getWidths(o,e,r),u=tu(o,i);y(u,(function(t){r.setElementWidth(t.element(),t.width())})),0<u.length&&r.setTableWidth(t,i,r.getCellDelta(0))},pu={insertRowBefore:vo((function(t,n,e,r){var o=n.row(),i=n.row();return Uo(Gi(t,i,o,e,r.getOrInit),i,n.column())}),bo,r,r,ou),insertRowsBefore:vo((function(t,n,e,r){var o=n[0].row(),i=n[0].row();return Uo(S(qo(n),(function(t,n){return Gi(t,i,o,e,r.getOrInit)}),t),i,n[0].column())}),yo,r,r,ou),insertRowAfter:vo((function(t,n,e,r){var o=n.row(),i=n.row()+n.rowspan();return Uo(Gi(t,i,o,e,r.getOrInit),i,n.column())}),bo,r,r,ou),insertRowsAfter:vo((function(t,n,e,r){var o=qo(n),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan();return Uo(S(o,(function(t,n){return Gi(t,u,i,e,r.getOrInit)}),t),u,n[0].column())}),yo,r,r,ou),insertColumnBefore:vo((function(t,n,e,r){var o=n.column(),i=n.column();return Uo(Yi(t,i,o,e,r.getOrInit),n.row(),i)}),bo,gu,r,ou),insertColumnsBefore:vo((function(t,n,e,r){var o=Vo(n),i=o[0].column(),u=o[0].column();return Uo(S(o,(function(t,n){return Yi(t,u,i,e,r.getOrInit)}),t),n[0].row(),u)}),yo,gu,r,ou),insertColumnAfter:vo((function(t,n,e,r){var o=n.column(),i=n.column()+n.colspan();return Uo(Yi(t,i,o,e,r.getOrInit),n.row(),i)}),bo,gu,r,ou),insertColumnsAfter:vo((function(t,n,e,r){var o=n[n.length-1].column(),i=n[n.length-1].column()+n[n.length-1].colspan();return Uo(S(Vo(n),(function(t,n){return Yi(t,i,o,e,r.getOrInit)}),t),n[0].row(),i)}),yo,gu,r,ou),splitCellIntoColumns:vo((function(t,n,e,r){var o=function(t,n,e,r,o){var i=e+1;return w(t,(function(t,u){var c=u===n?zn(o(Wi.getCellElement(t,e),r),!0):Wi.getCell(t,e);return Wi.addCell(t,i,c)}))}(t,n.row(),n.column(),e,r.getOrInit);return Uo(o,n.row(),n.column())}),bo,gu,r,ou),splitCellIntoRows:vo((function(t,n,e,r){var o=function(t,n,e,r,o){var i=n+1,u=t.slice(0,i),c=t.slice(i),a=Wi.mapCells(t[n],(function(t,n){return n===e?zn(o(t.element(),r),!0):t}));return u.concat([a]).concat(c)}(t,n.row(),n.column(),e,r.getOrInit);return Uo(o,n.row(),n.column())}),bo,r,r,ou),eraseColumns:vo((function(t,n,e,r){var o=Vo(n),i=function(t,n,e){var r=w(t,(function(t){var r=t.cells().slice(0,n).concat(t.cells().slice(e+1));return Fn(r,t.section())}));return C(r,(function(t){return 0<t.cells().length}))}(t,o[0].column(),o[o.length-1].column()),u=Fo(i,n[0].row(),n[0].column());return du(i,u)}),yo,gu,Ho,ou),eraseRows:vo((function(t,n,e,r){var o=qo(n),i=function(t,n,e){return t.slice(0,n).concat(t.slice(e+1))}(t,o[0].row(),o[o.length-1].row()),u=Fo(i,n[0].row(),n[0].column());return du(i,u)}),yo,r,Ho,ou),makeColumnHeader:vo((function(t,n,e,r){return Uo(Ki(t,n.column(),e,r.replaceOrInit),n.row(),n.column())}),bo,r,r,iu("row","th")),unmakeColumnHeader:vo((function(t,n,e,r){return Uo(Ki(t,n.column(),e,r.replaceOrInit),n.row(),n.column())}),bo,r,r,iu(null,"td")),makeRowHeader:vo((function(t,n,e,r){return Uo(Xi(t,n.row(),e,r.replaceOrInit),n.row(),n.column())}),bo,r,r,iu("col","th")),unmakeRowHeader:vo((function(t,n,e,r){return Uo(Xi(t,n.row(),e,r.replaceOrInit),n.row(),n.column())}),bo,r,r,iu(null,"td")),mergeCells:vo((function(t,n,e,r){var o=n.cells();su(o);var u=function(t,n,e,r){if(0===t.length)return t;for(var o=n.startRow();o<=n.finishRow();o++)for(var i=n.startCol();i<=n.finishCol();i++)Wi.mutateCell(t[o],i,zn(r(),!1));return t}(t,n.bounds(),0,i(o[0]));return du(u,Bt.from(o[0]))}),(function(t,n){return n.mergable()}),r,r,uu),unmergeCells:vo((function(t,n,e,r){var o=x(n,(function(t,n){return qi(t,n,e,r.combine(n))}),t);return du(o,Bt.from(n[0]))}),(function(t,n){return n.unmergable()}),gu,r,uu),pasteCells:vo((function(t,n,e,r){var o,c,a,l,f=(o=n.clipboard(),c=n.generators(),a=ie(o),l=ce(a),Li(l,c,!0));return function(t,n,e,r,o){return function(t,n,e){if(t.row()>=n.length||t.column()>Wi.cellLength(n[0]))return Hi.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=n.slice(t.row()),o=r[0].cells().slice(t.column()),u=Wi.cellLength(e[0]),c=e.length;return Hi.value({rowDelta:i(r.length-c),colDelta:i(o.length-u)})}(t,n,e).map((function(i){var c=Ui(n,i,r);return function(t,n,e,r,o){for(var i,c,a,l,f,s=t.row(),d=t.column(),m=s+e.length,g=d+Wi.cellLength(e[0]),p=s;p<m;p++)for(var h=d;h<g;h++){i=n,c=p,a=h,f=l=void 0,l=u(o,Wi.getCell(i[c],a).element()),f=i[c],1<i.length&&1<Wi.cellLength(f)&&(0<a&&l(Wi.getCellElement(f,a-1))||a<f.cells().length-1&&l(Wi.getCellElement(f,a+1))||0<c&&l(Wi.getCellElement(i[c-1],a))||c<i.length-1&&l(Wi.getCellElement(i[c+1],a)))&&qi(n,Wi.getCellElement(n[p],h),o,r.cell);var v=Wi.getCellElement(e[p-s],h-d),b=r.replace(v);Wi.mutateCell(n[p],h,zn(b,!0))}return n}(t,c,e,r,o)}))}(Mn(n.row(),n.column()),t,f,n.generators(),e).fold((function(){return du(t,Bt.some(n.element()))}),(function(t){var e=Fo(t,n.row(),n.column());return du(t,e)}))}),(function(t,n){return ee(n.element()).bind((function(e){return ho(t,e).map((function(t){return un(un({},t),{generators:n.generators,clipboard:n.clipboard})}))}))}),gu,r,ou),pasteRowsBefore:vo((function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[0].row(),u=Go(n.clipboard(),n.generators(),o),c=Vi(i,t,u,n.generators(),e),a=Fo(c,n.cells[0].row(),n.cells[0].column());return du(c,a)}),wo,r,r,ou),pasteRowsAfter:vo((function(t,n,e,r){var o=t[n.cells[0].row()],i=n.cells[n.cells.length-1].row()+n.cells[n.cells.length-1].rowspan(),u=Go(n.clipboard(),n.generators(),o),c=Vi(i,t,u,n.generators(),e),a=Fo(c,n.cells[0].row(),n.cells[0].column());return du(c,a)}),wo,r,r,ou)},hu=function(t){return nn.fromDom(t.getBody())},vu=function(t){return function(n){return En(n,hu(t))}},bu={isRtl:i(!1)},wu={isRtl:i(!0)},yu=function(t){return"rtl"===function(t){return"rtl"===ot(t,"direction")?"rtl":"ltr"}(t)?wu:bu},Cu={"border-collapse":"collapse",width:"100%"},xu={border:"1"},Su=function(t){var n=t.getParam("table_clone_elements");return kt(n)?Bt.some(n.split(/[ ,]/)):Array.isArray(n)?Bt.some(n):Bt.none()},Ru=function(t,n){function e(t){return"table"===Jt(hu(t))}function o(n,e,r,o){return function(u,c){$o(u);var a=o(),l=nn.fromDom(t.getDoc()),f=Zr(yu),s=Ie(r,l,i);return e(u)?n(a,u,c,s,f).bind((function(n){return y(n.newRows(),(function(n){ii(t,n.dom())})),y(n.newCells(),(function(n){ui(t,n.dom())})),n.cursor().map((function(n){var e=t.dom.createRng();return e.setStart(n.dom(),0),e.setEnd(n.dom(),0),e}))})):Bt.none()}}var i=Su(t);return{deleteRow:o(pu.eraseRows,(function(n){var r=xi(n);return!1===e(t)||1<r.rows()}),r,n),deleteColumn:o(pu.eraseColumns,(function(n){var r=xi(n);return!1===e(t)||1<r.columns()}),r,n),insertRowsBefore:o(pu.insertRowsBefore,s,r,n),insertRowsAfter:o(pu.insertRowsAfter,s,r,n),insertColumnsBefore:o(pu.insertColumnsBefore,s,Vr,n),insertColumnsAfter:o(pu.insertColumnsAfter,s,Vr,n),mergeCells:o(pu.mergeCells,s,r,n),unmergeCells:o(pu.unmergeCells,s,r,n),pasteRowsBefore:o(pu.pasteRowsBefore,s,r,n),pasteRowsAfter:o(pu.pasteRowsAfter,s,r,n),pasteCells:o(pu.pasteCells,s,r,n)}},Tu=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ou=function(t,n,e){e&&t.formatter.apply("align"+e,{},n)},Du=function(t,n,e){e&&t.formatter.apply("valign"+e,{},n)},Au=function(t,n){Tu.each("left center right".split(" "),(function(e){t.formatter.remove("align"+e,{},n)}))},Eu=function(t,n){Tu.each("top middle bottom".split(" "),(function(e){t.formatter.remove("valign"+e,{},n)}))},Nu=function(t,n,e){return function(n,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],e);if(void 0===n&&(n=i),n!==i)return""}return n}(undefined,t.select("td,th",n))},Pu=u(fi,"left center right"),Bu=u(fi,"top middle bottom"),Iu=function(t,n,e){var r=function(t,e){return e=e||[],Tu.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,n&&n(o)),e.push(o)})),e};return r(t,e||[])},ku=function(t){var n=t[0],e=t.slice(1),r=Ft(n);return y(e,(function(t){y(r,(function(e){N(t,(function(t,r){var o=n[e];""!==o&&e===r&&o!==t&&(n[e]="")}))}))})),n},Mu=function(t){var n=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}];return{title:"Advanced",name:"advanced",items:"cell"===t?[{name:"borderwidth",type:"input",label:"Border width"}].concat(n):n}},Wu=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],_u=function(t){return function(t){var n=function(t){return t.getParam("table_cell_class_list",[],"array")}(t),e=Iu(n,(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})}));return 0<n.length?Bt.some({name:"class",type:"selectbox",label:"Class",items:e}):Bt.none()}(t).fold((function(){return Wu}),(function(t){return Wu.concat(t)}))},Lu={normal:function(t,n){return{setAttrib:function(e,r){t.setAttrib(n,e,r)},setStyle:function(e,r){t.setStyle(n,e,r)}}},ifTruthy:function(t,n){return{setAttrib:function(e,r){r&&t.setAttrib(n,e,r)},setStyle:function(e,r){r&&t.setStyle(n,e,r)}}}},ju=function(t){var n,e=[];if(e=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),n=t.dom.getParent(t.selection.getStart(),"td,th"),!e.length&&n&&e.push(n),n=n||e[0]){var r=Tu.map(e,(function(n){return function(t,n,e){var r=t.dom;return un(un(un({width:r.getStyle(n,"width")||r.getAttrib(n,"width"),height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),celltype:n.nodeName.toLowerCase(),class:r.getAttrib(n,"class","")},Pu("align","halign",t,n)),Bu("valign","valign",t,n)),e?li(r,n):{})}(t,n,Zo(t))})),o=ku(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:_u(t)},Mu("cell")]},c={type:"panel",items:[{type:"grid",columns:2,items:_u(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:Zo(t)?i:c,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(pi,t,e)})}},zu=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],Hu=function(t){return function(t){var n=function(t){return t.getParam("table_row_class_list",[],"array")}(t),e=Iu(n,(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[n.value]})})}));return 0<n.length?Bt.some({name:"class",type:"selectbox",label:"Class",items:e}):Bt.none()}(t).fold((function(){return zu}),(function(t){return zu.concat(t)}))},Fu=function(t){var n,e,r=t.dom,o=[];if((n=r.getParent(t.selection.getStart(),"table"))&&(e=r.getParent(t.selection.getStart(),"td,th"),Tu.each(n.rows,(function(t){Tu.each(t.cells,(function(n){if((r.getAttrib(n,"data-mce-selected")||n===e)&&o.indexOf(t)<0)return o.push(t),!1}))})),o[0])){var i=Tu.map(o,(function(n){return function(t,n,e){var r=t.dom;return un(un({height:r.getStyle(n,"height")||r.getAttrib(n,"height"),scope:r.getAttrib(n,"scope"),class:r.getAttrib(n,"class",""),align:"",type:n.parentNode.nodeName.toLowerCase()},Pu("align","align",t,n)),e?li(r,n):{})}(t,n,ti(t))})),c=ku(i),a={type:"tabpanel",tabs:[{title:"General",name:"general",items:Hu(t)},Mu("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:Hu(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:ti(t)?a:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(hi,t,o,c)})}},Uu=Object.prototype.hasOwnProperty,qu=(Ci=function(t,n){return n},function(){for(var t=new Array(arguments.length),n=0;n<t.length;n++)t[n]=arguments[n];if(0===t.length)throw new Error("Can't merge zero objects");for(var e={},r=0;r<t.length;r++){var o=t[r];for(var i in o)Uu.call(o,i)&&(e[i]=Ci(e[i],o[i]))}return e}),Vu=tinymce.util.Tools.resolve("tinymce.Env"),Gu={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Yu=function(t,n,e){var r=Qo(t),o={styles:r,attributes:Jo(t),percentages:function(t){return kt(t)&&-1!==t.indexOf("%")}(r.width)&&!oi(t)},i=function(t,n,e,r,o){void 0===o&&(o=Gu);var i=nn.fromTag("table");rt(i,o.styles),q(i,o.attributes);var u=nn.fromTag("tbody");Bn(i,u);for(var c=[],a=0;a<t;a++){for(var l=nn.fromTag("tr"),f=0;f<n;f++){var s=a<0||f<0?nn.fromTag("th"):nn.fromTag("td");f<0&&U(s,"scope","row"),a<0&&U(s,"scope","col"),Bn(s,nn.fromTag("br")),o.percentages&&et(s,"width",100/n+"%"),Bn(l,s)}c.push(l)}return Ot(u,c),i}(e,n,0,0,o);U(i,"data-mce-id","__mce");var c=function(t){var n=nn.fromTag("div"),e=nn.fromDom(t.dom().cloneNode(!0));return Bn(n,e),function(t){return t.dom().innerHTML}(n)}(i);return t.insertContent(c),$n(hu(t),'table[data-mce-id="__mce"]').map((function(n){return oi(t)&&et(n,"width",ot(n,"width")),Y(n,"data-mce-id"),function(t,n){y(Nt(n,"tr"),(function(n){ii(t,n.dom()),y(Nt(n,"th,td"),(function(n){ui(t,n.dom())}))}))}(t,n),function(t,n){$n(n,"td,th").each(u(vi,t))}(t,n),n.dom()})).getOr(null)},Ku=function(t,n,e){var r=e?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=function(t){return t.getParam("table_appearance_options",!0,"boolean")}(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],i=n?[{type:"selectbox",name:"class",label:"Class",items:Iu(ri(t),(function(n){n.value&&(n.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[n.value]})})}))}]:[];return r.concat([{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}]).concat(o).concat([{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}]).concat(i)},Xu=function(t,n,e,r){if("TD"===n.tagName||"TH"===n.tagName)kt(e)?t.setStyle(n,e,r):t.setStyle(n,e);else if(n.children)for(var o=0;o<n.children.length;o++)Xu(t,n.children[o],e,r)},$u=function(t,n){var e,r=t.dom,o=function(t,n){var e,r,o,i,u,c,a,l=Qo(t),f=Jo(t),s=t.dom,d=n?(e=s,r=B(l,"border-style").getOr(""),o=B(l,"border-color").getOr(""),i=B(l,"background-color").getOr(""),{borderstyle:r,bordercolor:m(o),backgroundcolor:m(i)}):{};function m(t){return J(t,"rgb")?e.toHex(t):t}return un(un(un(un(un(un({},{height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""}),l),f),d),(a=l["border-width"],ei(t)&&a?{border:a}:B(f,"border").fold((function(){return{}}),(function(t){return{border:t}})))),(u=B(l,"border-spacing").or(B(f,"cellspacing")).fold((function(){return{}}),(function(t){return{cellspacing:t}})),c=B(l,"border-padding").or(B(f,"cellpadding")).fold((function(){return{}}),(function(t){return{cellpadding:t}})),un(un({},u),c)))}(t,ni(t));!1===n?(e=r.getParent(t.selection.getStart(),"table"))?o=function(t,n,e){var r,o,i,u=t.dom;return un(un({width:u.getStyle(n,"width")||u.getAttrib(n,"width"),height:u.getStyle(n,"height")||u.getAttrib(n,"height"),cellspacing:u.getStyle(n,"border-spacing")||u.getAttrib(n,"cellspacing"),cellpadding:u.getAttrib(n,"cellpadding")||Nu(t.dom,n,"padding"),border:(r=u,o=n,i=it(nn.fromDom(o),"border-width"),ei(t)&&i.isSome()?i.getOr(""):r.getAttrib(o,"border")||Nu(t.dom,o,"border-width")||Nu(t.dom,o,"border")),caption:!!u.select("caption",n)[0],class:u.getAttrib(n,"class","")},Pu("align","align",t,n)),e?li(u,n):{})}(t,e,ni(t)):ni(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""):(o.cols="1",o.rows="1",ni(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=0<ri(t).length;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var c={type:"grid",columns:2,items:Ku(t,i,n)},a=ni(t)?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[c]},Mu("table")]}:{type:"panel",items:[c]};t.windowManager.open({title:"Table Properties",size:"normal",body:a,onSubmit:u(bi,t,e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Ju=wi("th,td"),Qu=wi("th,td,caption"),Zu=Tu.each,tc=function(t,n,e,o,i){function a(t){return oe(t,m)}function l(t){return{width:Yo(t.dom()),height:Yo(t.dom())}}function f(n){Ju(t).each((function(r){a(r).each((function(i){var u=hr.forMenu(o,i,r),c=l(i);n(i,u).each((function(n){!function(t,n,e){var r=l(e);n.width===r.width&&n.height===r.height||(ci(t,e.dom(),n.width,n.height),ai(t,e.dom(),r.width,r.height))}(t,c,i),t.selection.setRng(n),t.focus(),e.clear(i),$o(i)}))}))}))}function s(n){return Ju(t).map((function(n){return a(n).bind((function(e){var i=nn.fromDom(t.getDoc());return function(t,n,e){var r=ie(t),o=ce(r);return yo(o,n).map((function(t){return function(t){return w(t,(function(t){var n=xe(t.element());return y(t.cells(),(function(t){var e=Se(t.element());eo(e,"colspan",t.colspan(),1),eo(e,"rowspan",t.rowspan(),1),Bn(n,e)})),n}))}(po(Li(o,e,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),e))}))}(e,hr.forMenu(o,e,n),Ie(r,i,Bt.none()))}))}))}function d(n){i.get().each((function(r){var i=w(r,(function(t){return Se(t)}));Ju(t).each((function(r){a(r).each((function(u){var c=nn.fromDom(t.getDoc()),a=ke(c),l=hr.pasteRows(o,u,r,i,a);n(u,l).each((function(n){t.selection.setRng(n),t.focus(),e.clear(u)}))}))}))}))}var m=vu(t);Zu({mceTableSplitCells:function(){f(n.unmergeCells)},mceTableMergeCells:function(){f(n.mergeCells)},mceTableInsertRowBefore:function(){f(n.insertRowsBefore)},mceTableInsertRowAfter:function(){f(n.insertRowsAfter)},mceTableInsertColBefore:function(){f(n.insertColumnsBefore)},mceTableInsertColAfter:function(){f(n.insertColumnsAfter)},mceTableDeleteCol:function(){f(n.deleteColumn)},mceTableDeleteRow:function(){f(n.deleteRow)},mceTableCutRow:function(t){s().each((function(t){i.set(t),f(n.deleteRow)}))},mceTableCopyRow:function(t){s().each((function(t){i.set(t)}))},mceTablePasteRowBefore:function(t){d(n.pasteRowsBefore)},mceTablePasteRowAfter:function(t){d(n.pasteRowsAfter)},mceTableDelete:function(){Qu(t).each((function(n){oe(n,m).filter(c(m)).each((function(n){var e=nn.fromText("");if(xt(n,e),In(n),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(e.dom(),0),r.setEnd(e.dom(),0),t.selection.setRng(r),t.nodeChanged()}}))}))}},(function(n,e){t.addCommand(e,n)})),Zu({mceInsertTable:u($u,t,!0),mceTableProps:u($u,t,!1),mceTableRowProps:u(Fu,t),mceTableCellProps:u(ju,t)},(function(n,e){t.addCommand(e,(function(){n()}))}))},nc=function(t){var n=Bt.from(t.dom().documentElement).map(nn.fromDom).getOr(t);return{parent:i(n),view:i(t),origin:i(Yr(0,0))}},ec=function(t){var n=I.apply(null,t),e=[];return{bind:function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");e.push(t)},unbind:function(t){e=C(e,(function(n){return n!==t}))},trigger:function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=n.apply(null,t);y(e,(function(t){t(o)}))}}},rc=function(t){return{registry:P(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),trigger:P(t,(function(t){return t.trigger}))}},oc=function(t,n,e,r){t.dom().removeEventListener(n,e,r)},ic=i(!0),uc={resolve:ao("ephox-dragster").resolve},cc=jo(["compare","extract","mutate","sink"]),ac=jo(["element","start","stop","destroy"]),lc=jo(["forceDrop","drop","move","delayDrop"]),fc=cc({compare:function(t,n){return Yr(n.left()-t.left(),n.top()-t.top())},extract:function(t){return Bt.some(Yr(t.x(),t.y()))},sink:function(t,n){var e=function(t){var n=qu({layerClass:uc.resolve("blocker")},t),e=nn.fromTag("div");return U(e,"role","presentation"),rt(e,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),oo(e,uc.resolve("blocker")),oo(e,n.layerClass),{element:function(){return e},destroy:function(){In(e)}}}(n),r=yi(e.element(),"mousedown",t.forceDrop),o=yi(e.element(),"mouseup",t.drop),i=yi(e.element(),"mousemove",t.move),u=yi(e.element(),"mouseout",t.delayDrop);return ac({element:e.element,start:function(t){Bn(t,e.element())},stop:function(){In(e.element())},destroy:function(){e.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()}})},mutate:function(t,n){t.mutate(n.left(),n.top())}});function sc(t){return"true"===V(t,"contenteditable")}function dc(t,n){return Yo(t.dom())/Yo(n.dom())*100+"%"}function mc(t,n){return oe(t,n).bind((function(n){var e=re(n);return T(e,(function(n){return En(t,n)})).map((function(t){return{index:i(t),all:i(e)}}))}))}function gc(t,n,e){var r=t.document.createRange();return function(t,n){n.fold((function(n){t.setStartBefore(n.dom())}),(function(n,e){t.setStart(n.dom(),e)}),(function(n){t.setStartAfter(n.dom())}))}(r,n),function(t,n){n.fold((function(n){t.setEndBefore(n.dom())}),(function(n,e){t.setEnd(n.dom(),e)}),(function(n){t.setEndAfter(n.dom())}))}(r,e),r}function pc(t,n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i}function hc(t){return{left:i(t.left),top:i(t.top),right:i(t.right),bottom:i(t.bottom),width:i(t.width),height:i(t.height)}}function vc(t,n,e){return n(nn.fromDom(e.startContainer),e.startOffset,nn.fromDom(e.endContainer),e.endOffset)}function bc(t,n){return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return ca.rtl(nn.fromDom(t.endContainer),t.endOffset,nn.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return vc(0,ca.ltr,e)})):vc(0,ca.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:i(t),rtl:Bt.none}},relative:function(n,e){return{ltr:Z((function(){return gc(t,n,e)})),rtl:Z((function(){return Bt.some(gc(t,e,n))}))}},exact:function(n,e,r,o){return{ltr:Z((function(){return pc(t,n,e,r,o)})),rtl:Z((function(){return Bt.some(pc(t,r,o,n,e))}))}}})}(t,n))}function wc(t,n,e){return n>=t.left&&n<=t.right&&e>=t.top&&e<=t.bottom}function yc(t,n){return n-t.left<t.right-n}function Cc(t,n,e){var r=t.dom().createRange();return r.selectNode(n.dom()),r.collapse(e),r}function xc(t,n,e){var r=t.dom().createRange();r.selectNode(n.dom());var o=yc(r.getBoundingClientRect(),e);return(!0===o?we:ye)(n).map((function(n){return Cc(t,n,o)}))}function Sc(t,n,e){var r=yc(n.dom().getBoundingClientRect(),e);return Bt.some(Cc(t,n,r))}function Rc(t,n){var e=Jt(t);return"input"===e?oa.after(t):v(["br","img"],e)?0===n?oa.before(t):oa.after(t):oa.on(t,n)}function Tc(t,n){var e=t.fold(oa.before,Rc,oa.after),r=n.fold(oa.before,Rc,oa.after);return ua.relative(e,r)}function Oc(t,n,e,r){var o=Rc(t,n),i=Rc(e,r);return ua.relative(o,i)}function Dc(t,n){Bt.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(n)}))}function Ac(t,n,e,r,o){Dc(t,pc(t,n,e,r,o))}function Ec(t,n){return bc(t,n).match({ltr:function(n,e,r,o){Ac(t,n,e,r,o)},rtl:function(n,e,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(n.dom(),e,r.dom(),o);else if(i.extend)try{!function(t,n,e,r,o,i){n.collapse(e.dom(),r),n.extend(o.dom(),i)}(0,i,n,e,r,o)}catch(i){Ac(t,r,o,n,e)}else Ac(t,r,o,n,e)}})}function Nc(t,n,e,r,o){Ec(t,Oc(n,e,r,o))}function Pc(t,n,e){Ec(t,Tc(n,e))}function Bc(t){var n=nn.fromDom(t.anchorNode),e=nn.fromDom(t.focusNode);return function(t,n,e,r){var o=function(t,n,e,r){var o=gt(t).dom().createRange();return o.setStart(t.dom(),n),o.setEnd(e.dom(),r),o}(t,n,e,r),i=En(t,e)&&n===r;return o.collapsed&&!i}(n,t.anchorOffset,e,t.focusOffset)?Bt.some(ea.create(n,t.anchorOffset,e,t.focusOffset)):function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return Bt.some(ea.create(nn.fromDom(n.startContainer),n.startOffset,nn.fromDom(e.endContainer),e.endOffset))}return Bt.none()}(t)}function Ic(t){return function(t){return Bt.from(t.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Bc)}(t).map((function(t){return ua.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))}function kc(t,n,e,r){return da(t,n,ta(e),r)}function Mc(t,n,e,r){return da(t,n,na(e),r)}function Wc(t,n){return function(t){function n(t,n,r,o){return pc(e,t,n,r,o)}var e=ua.getWin(t).dom(),r=function(t){return t.match({domRange:function(t){var n=nn.fromDom(t.startContainer),e=nn.fromDom(t.endContainer);return Oc(n,t.startOffset,e,t.endOffset)},relative:Tc,exact:Oc})}(t);return bc(e,r).match({ltr:n,rtl:n})}(ua.exact(n,0,n,0))}function _c(t,n,e,r){return void 0===r&&(r=Sa),t.property().parent(n).map((function(t){return xa(t,r)}))}function Lc(t){return function(n){return 0===t.property().children(n).length}}function jc(t,n){return function(t,n,e){return Aa(t,n,Lc(t),e)}(Na,t,n)}function zc(t,n){return function(t,n,e){return Ea(t,n,Lc(t),e)}(Na,t,n)}function Hc(t){return Jn(t,"tr")}function Fc(t){return"br"===Jt(t)}function Uc(t){return La.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})}function qc(t,n){return Bt.some(t.getRect(n))}function Vc(t,n,e){return function(t,n){return Gn((function(t,n){return n(t)}),Yn,t,n,void 0)}(n,lu).fold(i(!1),(function(n){return za(t,n).exists((function(t){return function(t,n){return t.left()<n.left()||Math.abs(n.right()-t.left())<1||t.left()>n.right()}(e,t)}))}))}function Gc(t,n,e){var r=t.move(e,5),o=qa(n,t,e,r,100).getOr(r);return function(t,n,e){return t.point(n)>e.getInnerHeight()?Bt.some(t.point(n)-e.getInnerHeight()):t.point(n)<0?Bt.some(-t.point(n)):Bt.none()}(t,o,n).fold((function(){return n.situsFromPoint(o.left(),t.point(o))}),(function(e){return n.scrollBy(0,e),n.situsFromPoint(o.left(),t.point(o)-e)}))}function Yc(t,n,e,r,o){return Jn(r,"td,th",n).bind((function(r){return Jn(r,"table",n).bind((function(u){return function(t,n){return function(t,n){return Yn(t,n,void 0).isSome()}(t,(function(t){return pt(t).exists((function(t){return En(t,n)}))}))}(o,u)?Ja(t,n,e).bind((function(t){return Jn(t.finish(),"td,th",n).map((function(n){return{start:i(r),finish:i(n),range:i(t)}}))})):Bt.none()}))}))}function Kc(t,n){return Jn(t,"td,th",n)}var Xc=function(n,e){return void 0===e&&(e={}),function(n,e,o){function i(){s.stop(),a.isOn()&&(a.off(),c.trigger.stop())}var u=!1,c=rc({start:ec([]),stop:ec([])}),a=function(){var t={onEvent:r,reset:r},n=function(){var t=Bt.none(),n=rc({move:ec(["info"])});return{onEvent:function(e,r){r.extract(e).each((function(e){(function(n,e){var r=t.map((function(t){return n.compare(t,e)}));return t=Bt.some(e),r})(r,e).each((function(t){n.trigger.move(t)}))}))},reset:function(){t=Bt.none()},events:n.registry}}(),e=t;return{on:function(){e.reset(),e=n},off:function(){e.reset(),e=t},isOn:function(){return e===n},onEvent:function(t,n){e.onEvent(t,n)},events:n.events}}(),l=function(n){var e=null;return{cancel:function(){null!==e&&(t.clearTimeout(e),e=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];null!==e&&t.clearTimeout(e),e=t.setTimeout((function(){n.apply(null,r),e=null}),200)}}}(i);function f(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];u&&t.apply(null,n)}}a.events.move.bind((function(t){e.mutate(n,t.info())}));var s=e.sink(lc({forceDrop:i,drop:f(i),move:f((function(t){l.cancel(),a.onEvent(t,e)})),delayDrop:f(l.throttle)}),o);return{element:s.element,go:function(t){s.start(t),a.on(),c.trigger.start()},on:function(){u=!0},off:function(){u=!1},destroy:function(){s.destroy()},events:c.registry}}(n,void 0!==e.mode?e.mode:fc,e)},$c=Di.resolve("resizer-bar-dragging"),Jc=function(t){function n(t){return"TABLE"===t.nodeName}function e(n){var e=t.dom.getStyle(n,"width")||t.dom.getAttrib(n,"width");return Bt.from(e).filter((function(t){return 0<t.length}))}function r(){return l}var o,c,a=Bt.none(),l=Bt.none(),f=Bt.none(),s=/(\d+(\.\d+)?)%/;return t.on("init",(function(){var n=Zr(yu),e=function(t){return t.inline?function(t,n){return{parent:i(n),view:i(t),origin:i(Yr(0,0))}}(hu(t),function(){var t=nn.fromTag("div");return rt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Bn(en(),t),t}()):nc(nn.fromDom(t.getDoc()))}(t);if(f=Bt.some(e),function(t){var n=t.getParam("object_resizing",!0);return kt(n)?"table"===n:n}(t)&&function(t){return t.getParam("table_resize_bars",!0,"boolean")}(t)){var r=function(t,n){var e=Jr.height,r=function(t,n,e){function r(t,n){return Bt.from(V(t,n))}var o=function(){var t=rc({drag:ec(["xDelta","yDelta","target"])}),n=Bt.none(),e=function(){var t=rc({drag:ec(["xDelta","yDelta"])});return{mutate:function(n,e){t.trigger.drag(n,e)},events:t.registry}}();return e.events.drag.bind((function(e){n.each((function(n){t.trigger.drag(e.xDelta(),e.yDelta(),n)}))})),{assign:function(t){n=Bt.some(t)},get:function(){return n},mutate:e.mutate,events:t.registry}}(),i=Xc(o,{}),c=Bt.none();function a(t,n){return Qi.getInt(t,n)-parseInt(V(t,"data-initial-"+n),10)}function l(n,e){m.trigger.startAdjust(),o.assign(n),U(n,"data-initial-"+e,parseInt(ot(n,e),10)),oo(n,$c),et(n,"opacity","0.2"),i.go(t.parent())}function f(n){return En(n,t.view())}o.events.drag.bind((function(t){r(t.target(),"data-row").each((function(n){var e=Qi.getInt(t.target(),"top");et(t.target(),"top",e+t.yDelta()+"px")})),r(t.target(),"data-column").each((function(n){var e=Qi.getInt(t.target(),"left");et(t.target(),"left",e+t.xDelta()+"px")}))})),i.events.stop.bind((function(){o.get().each((function(o){c.each((function(i){r(o,"data-row").each((function(t){var n=a(o,"top");Y(o,"data-initial-top"),m.trigger.adjustHeight(i,n,parseInt(t,10))})),r(o,"data-column").each((function(t){var n=a(o,"left");Y(o,"data-initial-left"),m.trigger.adjustWidth(i,n,parseInt(t,10))})),Pi(t,i,e,n)}))}))}));var s=yi(t.parent(),"mousedown",(function(t){(function(t){return io(t,Ei)})(t.target())&&l(t.target(),"top"),function(t){return io(t,Ni)}(t.target())&&l(t.target(),"left")})),d=yi(t.view(),"mouseover",(function(r){(function(t){return Jn(t,"table",f).filter((function(t){return function(t,n){return Jn(t,"[contenteditable]",n)}(t,f).exists(sc)}))})(r.target()).fold((function(){tt(r.target())&&ki(t)}),(function(r){c=Bt.some(r),Pi(t,r,e,n)}))})),m=rc({adjustHeight:ec(["table","delta","row"]),adjustWidth:ec(["table","delta","column"]),startAdjust:ec([])});return{destroy:function(){s.unbind(),d.unbind(),i.destroy(),ki(t)},refresh:function(r){Pi(t,r,e,n)},on:i.on,off:i.off,hideBars:u(Bi,t),showBars:u(Ii,t),events:m.registry}}(t,n,e),o=rc({beforeResize:ec(["table"]),afterResize:ec(["table"]),startDrag:ec([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());(function(t,n,e,r){var o=_o(t),u=w(Zi.getPixelHeights(o,r),(function(t,r){return e===r?Math.max(n+t,Qi.minHeight()):t})),c=function(t,n){return w(se(t),(function(t){var e=ko(t.row(),t.row()+t.rowspan(),n);return{element:t.element,height:i(e),rowspan:t.rowspan}}))}(o,u),a=function(t,n){return w(t.all(),(function(t,e){return{element:t.element,height:i(n[e])}}))}(o,u);y(a,(function(t){qr.setHeight(t.element(),t.height())})),y(c,(function(t){qr.setHeight(t.element(),t.height())}));var l=function(t){return x(t,(function(t,n){return t+n}),0)}(u);qr.setHeight(t,l)})(t.table(),n,t.row(),e),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());(function(t,n,e,r){var o=nu(t),u=o.getCellDelta(n),c=_o(t),a=o.getWidths(c,r,o),l=function(t,n,e,r){function o(t){return w(t,i(0))}function u(t,n){if(0<=e){var i=Math.max(r.minCellWidth(),c[n]-e);return o(c.slice(0,t)).concat([e,i-c[n]]).concat(o(c.slice(n+1)))}var u=Math.max(r.minCellWidth(),c[t]+e),a=c[t]-u;return o(c.slice(0,t)).concat([u-c[t],a]).concat(o(c.slice(n+1)))}var c=t.slice(0),a=function(t,n){return 0===t.length?Ji.none():1===t.length?Ji.only(0):0===n?Ji.left(0,1):n===t.length-1?Ji.right(n-1,n):0<n&&n<t.length-1?Ji.middle(n-1,n,n+1):Ji.none()}(t,n),l=i(o(c)),f=u;return a.fold(l,(function(t){return r.singleColumnWidth(c[t],e)}),f,(function(t,n,e){return u(n,e)}),(function(t,n){if(0<=e)return o(c.slice(0,n)).concat([e]);var i=Math.max(r.minCellWidth(),c[n]+e);return o(c.slice(0,n)).concat([i-c[n]])}))}(a,e,u,o),f=w(l,(function(t,n){return t+a[n]}));y(tu(c,f),(function(t){o.setElementWidth(t.element(),t.width())})),e===c.grid().columns()-1&&o.setTableWidth(t,f,u)})(t.table(),e,t.column(),n),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}(e,n);r.on(),r.events.startDrag.bind((function(n){a=Bt.some(t.selection.getRng())})),r.events.beforeResize.bind((function(n){var e=n.table().dom();ci(t,e,Yo(e),Ko(e))})),r.events.afterResize.bind((function(n){var e=n.table(),r=e.dom();$o(e),a.each((function(n){t.selection.setRng(n),t.focus()})),ai(t,r,Yo(r),Ko(r)),t.undoManager.add()})),l=Bt.some(r)}})),t.on("ObjectResizeStart",(function(r){var i=r.target;if(n(i)){var u=e(i).map((function(t){return s.test(t)})).getOr(!1);u&&oi(t)?function(t){et(nn.fromDom(t),"width",Yo(t).toString()+"px")}(i):!u&&function(t){return!0===t.getParam("table_responsive_width")}(t)&&function(t){var n=nn.fromDom(t);pt(n).map((function(t){return dc(n,t)})).each((function(t){et(n,"width",t),y(Nt(n,"tr"),(function(t){y(wt(t),(function(n){et(n,"width",dc(n,t))}))}))}))}(i),o=r.width,c=e(i).getOr("")}})),t.on("ObjectResized",(function(e){var r=e.target;if(n(r)){var i=r;if(s.test(c)){var u=parseFloat(s.exec(c)[1]),a=e.width*u/o;t.dom.setStyle(i,"width",a+"%")}else{var l=[];Tu.each(i.rows,(function(n){Tu.each(n.cells,(function(n){var e=t.dom.getStyle(n,"width",!0);l.push({cell:n,width:e})}))})),Tu.each(l,(function(n){t.dom.setStyle(n.cell,"width",n.width),t.dom.setAttrib(n.cell,"width",null)}))}}})),t.on("SwitchMode",(function(){r().each((function(n){t.readonly?n.hideBars():n.showBars()}))})),{lazyResize:r,lazyWire:function(){return f.getOr(nc(nn.fromDom(t.getBody())))},destroy:function(){l.each((function(t){t.destroy()})),f.each((function(n){!function(t,n){t.inline&&In(n.parent())}(t,n)}))}}},Qc=fr([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Zc=un(un({},Qc),{none:function(t){return void 0===t&&(t=void 0),Qc.none(t)}}),ta=function(t,n){return mc(t,n).fold((function(){return Zc.none(t)}),(function(n){return n.index()+1<n.all().length?Zc.middle(t,n.all()[n.index()+1]):Zc.last(t)}))},na=function(t,n){return mc(t,n).fold((function(){return Zc.none()}),(function(n){return 0<=n.index()-1?Zc.middle(t,n.all()[n.index()-1]):Zc.first(t)}))},ea={create:I("start","soffset","finish","foffset")},ra=fr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),oa={before:ra.before,on:ra.on,after:ra.after,cata:function(t,n,e,r){return t.fold(n,e,r)},getStart:function(t){return t.fold(n,n,n)}},ia=fr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ua={domRange:ia.domRange,relative:ia.relative,exact:ia.exact,exactFromRange:function(t){return ia.exact(t.start(),t.soffset(),t.finish(),t.foffset())},getWin:function(t){return function(t){return nn.fromDom(t.dom().ownerDocument.defaultView)}(function(t){return t.match({domRange:function(t){return nn.fromDom(t.startContainer)},relative:function(t,n){return oa.getStart(t)},exact:function(t,n,e,r){return t}})}(t))},range:ea.create},ca=fr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),aa=function(t,n){return bc(t,n).match({ltr:function(n,e,r,o){var i=t.document.createRange();return i.setStart(n.dom(),e),i.setEnd(r.dom(),o),i},rtl:function(n,e,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(n.dom(),e),i}})},la=function(t,n,e,r){return Zt(n)?function(t,n,e,r){var o=t.dom().createRange();return o.selectNode(n.dom()),no(o.getClientRects(),(function(t){return wc(t,e,r)?Bt.some(t):Bt.none()})).map((function(o){return function(t,n,e,r,o){function i(e){var r=t.dom().createRange();return r.setStart(n.dom(),e),r.collapse(!0),r}var u=ge(n).length,c=function(t,n,e,r,o){if(0===o)return 0;if(n===r)return o-1;for(var i=r,u=1;u<o;u++){var c=t(u),a=Math.abs(n-c.left);if(e<=c.bottom){if(e<c.top||i<a)return u-1;i=a}}return 0}((function(t){return i(t).getBoundingClientRect()}),e,r,o.right,u);return i(c)}(t,n,e,r,o)}))}(t,n,e,r):function(t,n,e,r){var o=t.dom().createRange();return no(wt(n),(function(n){return o.selectNode(n.dom()),wc(o.getBoundingClientRect(),e,r)?la(t,n,e,r):Bt.none()}))}(t,n,e,r)},fa=document.caretPositionFromPoint?function(t,n,e){return Bt.from(t.dom().caretPositionFromPoint(n,e)).bind((function(n){if(null===n.offsetNode)return Bt.none();var e=t.dom().createRange();return e.setStart(n.offsetNode,n.offset),e.collapse(),Bt.some(e)}))}:document.caretRangeFromPoint?function(t,n,e){return Bt.from(t.dom().caretRangeFromPoint(n,e))}:function(t,n,e){return nn.fromPoint(t,n,e).bind((function(r){function o(){return function(t,n,e){return(0===wt(n).length?Sc:xc)(t,n,e)}(t,r,n)}return 0===wt(r).length?o():function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect();return function(t,n,e,r){var o=t.dom().createRange();o.selectNode(n.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,e)),c=Math.max(i.top,Math.min(i.bottom,r));return la(t,n,u,c)}(t,n,Math.max(i.left,Math.min(i.right,e)),Math.max(i.top,Math.min(i.bottom,r)))}(t,r,n,e).orThunk(o)}))},sa=tinymce.util.Tools.resolve("tinymce.util.VK"),da=function(t,n,e,r,o){return e.fold(Bt.none,Bt.none,(function(t,n){return we(n).map((function(t){return Wc(0,t)}))}),(function(e){return oe(e,n).bind((function(n){var o=hr.noMenu(e);return t.undoManager.transact((function(){r.insertRowsAfter(n,o)})),function(t,n){return function(t){return 0===t.length?Bt.none():Bt.some(t[t.length-1])}(Nt(n,"tr")).bind((function(t){return $n(t,"td,th").map((function(t){return Wc(0,t)}))}))}(0,n)}))}))},ma=["table","li","dl"],ga=function(t,n,e,r){if(t.keyCode===sa.TAB){var o=hu(n),i=function(t){var n=Jt(t);return En(t,o)||v(ma,n)},u=n.selection.getRng();if(u.collapsed){var c=nn.fromDom(u.startContainer);ee(c,i).each((function(o){t.preventDefault(),(t.shiftKey?Mc:kc)(n,i,o,e,r).each((function(t){n.selection.setRng(t)}))}))}}},pa={create:I("selection","kill")},ha=function(t,n,e,r){return{start:i(oa.on(t,n)),finish:i(oa.on(e,r))}},va=function(t,n){var e=aa(t,n);return ea.create(nn.fromDom(e.startContainer),e.startOffset,nn.fromDom(e.endContainer),e.endOffset)},ba=ha,wa=function(t,n,e,r,o){return En(e,r)?Bt.none():ir(e,r,n).bind((function(n){var r=n.boxes().getOr([]);return 0<r.length?(o(t,r,n.start(),n.finish()),Bt.some(pa.create(Bt.some(ba(e,0,e,ve(e))),!0))):Bt.none()}))},ya=wa,Ca=function(t,n,e,r,o){return function(t,n,e,r,o){return function(t,n){return R(t,(function(t){return dt(t,n)}))}(t,o).bind((function(t){return function(t,n,e){return oe(t).bind((function(r){return function(t,n,e,r){return le(t,n,En).bind((function(n){var o=0<e?n.row()+n.rowspan()-1:n.row(),i=0<r?n.column()+n.colspan()-1:n.column();return ae(t,o+e,i+r).map((function(t){return t.element()}))}))}(je(r),t,n,e)}))}(t,n,e).bind((function(t){return function(t,n){return Kn(t,"table").bind((function(e){return $n(e,n).bind((function(n){return Ke(n,t).bind((function(t){return t.boxes().map((function(n){return{boxes:i(n),start:i(t.start()),finish:i(t.finish())}}))}))}))}))}(t,r)}))}))}(r,t,n,o.firstSelectedSelector(),o.lastSelectedSelector()).map((function(t){return o.clearBeforeUpdate(e),o.selectRange(e,t.boxes(),t.start(),t.finish()),t.boxes()}))},xa=I("item","mode"),Sa=function(t,n,e,r){return void 0===r&&(r=Ra),e.sibling(t,n).map((function(t){return xa(t,r)}))},Ra=function(t,n,e,r){void 0===r&&(r=Ra);var o=t.property().children(n);return e.first(o).map((function(t){return xa(t,r)}))},Ta=[{current:_c,next:Sa,fallback:Bt.none()},{current:Sa,next:Ra,fallback:Bt.some(_c)},{current:Ra,next:Ra,fallback:Bt.some(Sa)}],Oa=function(t,n,e,r,o){return void 0===o&&(o=Ta),R(o,(function(t){return t.current===e})).bind((function(e){return e.current(t,n,r,e.next).orThunk((function(){return e.fallback.bind((function(e){return Oa(t,n,e,r)}))}))}))},Da=function(t,n,e,r,o,i){return Oa(t,n,r,o).bind((function(n){return i(n.item())?Bt.none():e(n.item())?Bt.some(n.item()):Da(t,n.item(),e,n.mode(),o,i)}))},Aa=function(t,n,e,r){return Da(t,n,e,Sa,{sibling:function(t,n){return t.query().prevSibling(n)},first:function(t){return 0<t.length?Bt.some(t[t.length-1]):Bt.none()}},r)},Ea=function(t,n,e,r){return Da(t,n,e,Sa,{sibling:function(t,n){return t.query().nextSibling(n)},first:function(t){return 0<t.length?Bt.some(t[0]):Bt.none()}},r)},Na=Ue(),Pa=I("element","offset"),Ba=(I("element","deltaOffset"),I("element","start","finish"),I("begin","end"),I("element","text"),fr([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),Ia=un(un({},Ba),{verify:function(t,n,e,r,o,i,u){return Jn(r,"td,th",u).bind((function(e){return Jn(n,"td,th",u).map((function(n){return En(e,n)?En(r,e)&&ve(e)===o?i(n):Ba.none("in same cell"):rr.sharedOne(Hc,[e,n]).fold((function(){return function(t,n,e){var r=t.getRect(n),o=t.getRect(e);return o.right>r.left&&o.left<r.right}(t,n,e)?Ba.success():i(n)}),(function(t){return i(n)}))}))})).getOr(Ba.none("default"))},cata:function(t,n,e,r,o){return t.fold(n,e,r,o)}}),ka=(I("ancestor","descendants","element","index"),I("parent","children","element","index")),Ma=function(t,n,e){return n(t,e).bind((function(t){return Zt(t)&&0===ge(t).trim().length?Ma(t,n,e):Bt.some(t)}))},Wa=function(t,n,e,r){return(Fc(n)?function(t,n,e){return e.traverse(n).orThunk((function(){return Ma(n,e.gather,t)})).map(e.relative)}(t,n,r):function(t,n,e,r){return function(t,n){return yt(t,n).filter(Fc).orThunk((function(){return yt(t,n-1).filter(Fc)}))}(n,e).bind((function(n){return r.traverse(n).fold((function(){return Ma(n,r.gather,t).map(r.relative)}),(function(t){return function(t){return pt(t).bind((function(n){var e=wt(n);return function(t,n){return T(t,u(En,n))}(e,t).map((function(r){return ka(n,e,t,r)}))}))}(t).map((function(t){return oa.on(t.parent(),t.index())}))}))}))}(t,n,e,r)).map((function(t){return{start:i(t),finish:i(t)}}))},_a=Gt(["left","top","right","bottom"],[]),La={nu:_a,moveUp:function(t,n){return _a({left:t.left(),top:t.top()-n,right:t.right(),bottom:t.bottom()-n})},moveDown:function(t,n){return _a({left:t.left(),top:t.top()+n,right:t.right(),bottom:t.bottom()+n})},moveBottomTo:function(t,n){var e=t.bottom()-t.top();return _a({left:t.left(),top:n-e,right:t.right(),bottom:n})},moveTopTo:function(t,n){var e=t.bottom()-t.top();return _a({left:t.left(),top:n,right:t.right(),bottom:n+e})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,n,e){return _a({left:t.left()+n,top:t.top()+e,right:t.right()+n,bottom:t.bottom()+e})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},ja=function(t,n,e){return Qt(n)?qc(t,n).map(Uc):Zt(n)?function(t,n,e){return 0<=e&&e<ve(n)?t.getRangedRect(n,e,n,e+1):0<e?t.getRangedRect(n,e-1,n,e):Bt.none()}(t,n,e).map(Uc):Bt.none()},za=function(t,n){return Qt(n)?qc(t,n).map(Uc):Zt(n)?t.getRangedRect(n,0,n,ve(n)).map(Uc):Bt.none()},Ha=fr([{none:[]},{retry:["caret"]}]),Fa={point:La.getTop,adjuster:function(t,n,e,r,o){var i=La.moveUp(o,5);return Math.abs(e.top()-r.top())<1||e.bottom()<o.top()?Ha.retry(i):e.bottom()===o.top()?Ha.retry(La.moveUp(o,1)):Vc(t,n,o)?Ha.retry(La.translate(i,5,0)):Ha.none()},move:La.moveUp,gather:jc},Ua={point:La.getBottom,adjuster:function(t,n,e,r,o){var i=La.moveDown(o,5);return Math.abs(e.bottom()-r.bottom())<1||e.top()>o.bottom()?Ha.retry(i):e.top()===o.bottom()?Ha.retry(La.moveDown(o,1)):Vc(t,n,o)?Ha.retry(La.translate(i,5,0)):Ha.none()},move:La.moveDown,gather:zc},qa=function(t,n,e,r,o){return 0===o?Bt.some(r):function(t,n,e){return t.elementFromPoint(n,e).filter((function(t){return"table"===Jt(t)})).isSome()}(t,r.left(),n.point(r))?function(t,n,e,r,o){return qa(t,n,e,n.move(r,5),o)}(t,n,e,r,o-1):t.situsFromPoint(r.left(),n.point(r)).bind((function(i){return i.start().fold(Bt.none,(function(i){return za(t,i).bind((function(u){return n.adjuster(t,i,u,e,r).fold(Bt.none,(function(r){return qa(t,n,e,r,o-1)}))})).orThunk((function(){return Bt.some(r)}))}),Bt.none)}))},Va={tryUp:u(Gc,Fa),tryDown:u(Gc,Ua),ieTryUp:function(t,n){return t.situsFromPoint(n.left(),n.top()-5)},ieTryDown:function(t,n){return t.situsFromPoint(n.left(),n.bottom()+5)},getJumpSize:i(5)},Ga=st(),Ya=function(t,n,e,r,o,i){return 0===i?Bt.none():$a(t,n,e,r,o).bind((function(u){var c=t.fromSitus(u),a=Ia.verify(t,e,r,c.finish(),c.foffset(),o.failure,n);return Ia.cata(a,(function(){return Bt.none()}),(function(){return Bt.some(u)}),(function(u){return En(e,u)&&0===r?Ka(t,e,r,La.moveUp,o):Ya(t,n,u,0,o,i-1)}),(function(u){return En(e,u)&&r===ve(u)?Ka(t,e,r,La.moveDown,o):Ya(t,n,u,ve(u),o,i-1)}))}))},Ka=function(t,n,e,r,o){return ja(t,n,e).bind((function(n){return Xa(t,o,r(n,Va.getJumpSize()))}))},Xa=function(t,n,e){return Ga.browser.isChrome()||Ga.browser.isSafari()||Ga.browser.isFirefox()||Ga.browser.isEdge()?n.otherRetry(t,e):Ga.browser.isIE()?n.ieRetry(t,e):Bt.none()},$a=function(t,n,e,r,o){return ja(t,e,r).bind((function(n){return Xa(t,o,n)}))},Ja=function(t,n,e){return function(t,n,e){return t.getSelection().bind((function(r){return Wa(n,r.finish(),r.foffset(),e).fold((function(){return Bt.some(Pa(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o);return function(t){return Ia.cata(t,(function(t){return Bt.none()}),(function(){return Bt.none()}),(function(t){return Bt.some(Pa(t,0))}),(function(t){return Bt.some(Pa(t,ve(t)))}))}(Ia.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),e.failure,n))}))}))}(t,n,e).bind((function(r){return Ya(t,n,r.element(),r.offset(),e,20).map(t.fromSitus)}))},Qa=st(),Za=function(t,n,e,r,o,i){return Qa.browser.isIE()?Bt.none():i(r,n).orThunk((function(){return Yc(t,n,e,r,o).map((function(t){var n=t.range();return pa.create(Bt.some(ba(n.start(),n.soffset(),n.finish(),n.foffset())),!0)}))}))},tl=function(t,n,e,r,o,i,u){return Yc(t,e,r,o,i).bind((function(t){return ya(n,e,t.start(),t.finish(),u)}))},nl=function(t,n){return Jn(t,"tr",n).bind((function(t){return Jn(t,"table",n).bind((function(e){var r=Nt(e,"tr");return En(t,r[0])?function(t,n,e){return Aa(Na,t,(function(t){return ye(t).isSome()}),e)}(e,0,n).map((function(t){var n=ve(t);return pa.create(Bt.some(ba(t,n,t,n)),!0)})):Bt.none()}))}))},el=function(t,n){return Jn(t,"tr",n).bind((function(t){return Jn(t,"table",n).bind((function(e){var r=Nt(e,"tr");return En(t,r[r.length-1])?function(t,n,e){return Ea(Na,t,(function(t){return we(t).isSome()}),e)}(e,0,n).map((function(t){return pa.create(Bt.some(ba(t,0,t,0)),!0)})):Bt.none()}))}))};function rl(t){return function(n){return n===t}}function ol(n){return{elementFromPoint:function(t,e){return nn.fromPoint(nn.fromDom(n.document),t,e)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(t,e,r,o){var i=ua.exact(t,e,r,o);return function(t,n){return function(t){var n=t.getClientRects(),e=0<n.length?n[0]:t.getBoundingClientRect();return 0<e.width||0<e.height?Bt.some(e).map(hc):Bt.none()}(aa(t,n))}(n,i).map(ll)},getSelection:function(){return Ic(n).map((function(t){return va(n,t)}))},fromSitus:function(t){var e=ua.relative(t.start(),t.finish());return va(n,e)},situsFromPoint:function(t,e){return function(t,n,e){return function(t,n,e){var r=nn.fromDom(t.document);return fa(r,n,e).map((function(t){return ea.create(nn.fromDom(t.startContainer),t.startOffset,nn.fromDom(t.endContainer),t.endOffset)}))}(t,n,e)}(n,t,e).map((function(t){return ha(t.start(),t.soffset(),t.finish(),t.foffset())}))},clearSelection:function(){!function(t){t.getSelection().removeAllRanges()}(n)},collapseSelection:function(t){void 0===t&&(t=!1),Ic(n).each((function(e){return e.fold((function(n){return n.collapse(t)}),(function(e,r){var o=t?e:r;Pc(n,o,o)}),(function(e,r,o,i){var u=t?e:o,c=t?r:i;Nc(n,u,c,u,c)}))}))},setSelection:function(t){Nc(n,t.start(),t.soffset(),t.finish(),t.foffset())},setRelativeSelection:function(t,e){Pc(n,t,e)},selectContents:function(t){!function(t,n){var e=function(t,n){var e=t.document.createRange();return function(t,n){t.selectNodeContents(n.dom())}(e,n),e}(t,n);Dc(t,e)}(n,t)},getInnerHeight:function(){return n.innerHeight},getScrollY:function(){return function(n){var e=void 0!==n?n.dom():t.document,r=e.body.scrollLeft||e.documentElement.scrollLeft,o=e.body.scrollTop||e.documentElement.scrollTop;return Yr(r,o)}(nn.fromDom(n.document)).top()},scrollBy:function(e,r){!function(n,e,r){(void 0!==r?r.dom():t.document).defaultView.scrollBy(n,e)}(e,r,nn.fromDom(n.document))}}}var il={down:{traverse:bt,gather:zc,relative:oa.before,otherRetry:Va.tryDown,ieRetry:Va.ieTryDown,failure:Ia.failedDown},up:{traverse:vt,gather:jc,relative:oa.before,otherRetry:Va.tryUp,ieRetry:Va.ieTryUp,failure:Ia.failedUp}},ul=rl(38),cl=rl(40),al={ltr:{isBackward:rl(37),isForward:rl(39)},rtl:{isBackward:rl(39),isForward:rl(37)},isUp:ul,isDown:cl,isNavigation:function(t){return 37<=t&&t<=40}},ll=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},fl=(st().browser.isSafari(),I("rows","cols")),sl=function(t,n,e,r){function o(){return r.clear(n),Bt.none()}var i=ol(t);return{keydown:function(t,c,a,l,f,s){var d=t.raw(),m=d.which,g=!0===d.shiftKey;return ur(n,r.selectedSelector()).fold((function(){return al.isDown(m)&&g?u(tl,i,n,e,il.down,l,c,r.selectRange):al.isUp(m)&&g?u(tl,i,n,e,il.up,l,c,r.selectRange):al.isDown(m)?u(Za,i,e,il.down,l,c,el):al.isUp(m)?u(Za,i,e,il.up,l,c,nl):Bt.none}),(function(t){function e(e){return function(){return no(e,(function(e){return Ca(e.rows(),e.cols(),n,t,r)})).fold((function(){return cr(n,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var e=al.isDown(m)||s.isForward(m)?oa.after:oa.before;return i.setRelativeSelection(oa.on(t.first(),0),e(t.table())),r.clear(n),pa.create(Bt.none(),!0)}))}),(function(t){return Bt.some(pa.create(Bt.none(),!0))}))}}return al.isDown(m)&&g?e([fl(1,0)]):al.isUp(m)&&g?e([fl(-1,0)]):s.isBackward(m)&&g?e([fl(0,-1),fl(-1,0)]):s.isForward(m)&&g?e([fl(0,1),fl(1,0)]):al.isNavigation(m)&&0==g?o:Bt.none}))()},keyup:function(t,o,i,u,c){return ur(n,r.selectedSelector()).fold((function(){var a=t.raw(),l=a.which;return 0==(!0===a.shiftKey)?Bt.none():al.isNavigation(l)?function(t,n,e,r,o,i,u){return En(e,o)&&r===i?Bt.none():Jn(e,"td,th",n).bind((function(e){return Jn(o,"td,th",n).bind((function(r){return wa(t,n,e,r,u)}))}))}(n,e,o,i,u,c,r.selectRange):Bt.none()}),Bt.none)}}},dl=function(t,n,e){var r=ie(t),o=ce(r);return yo(o,n).map((function(t){var n=Li(o,e,!1);return{upOrLeftCells:function(t,n,e){return D(po(t.slice(0,n[n.length-1].row()+1),e),(function(t){return w(t.cells().slice(0,n[n.length-1].column()+1),(function(t){return t.element()}))}))}(n,t,e),downOrRightCells:function(t,n,e){return D(po(t.slice(n[0].row()+n[0].rowspan()-1,t.length),e),(function(t){return w(t.cells().slice(n[0].column()+n[0].colspan()-1,+t.cells().length),(function(t){return t.element()}))}))}(n,t,e)}}))},ml=function(t){return!1===io(nn.fromDom(t.target),"ephox-snooker-resizer-bar")};It.add("table",(function(n){var u=function(t){return{get:function(){return function(t,n){return ur(t,n)}(hu(t),lr.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?dr.none():dr.single(t.selection)}),(function(t){return dr.multiple(t)}))}}}(n),c=function(t,n){function r(){return Qu(t).bind((function(t){return oe(t).map((function(e){return"caption"===Jt(t)?hr.notCell(t):hr.forMenu(n,e,t)}))}))}function o(){u.set(Z(r)()),y(c.get(),(function(t){return t()}))}function i(t,n){function e(){return u.get().fold((function(){t.setDisabled(!0)}),(function(e){t.setDisabled(n(e))}))}return e(),c.set(c.get().concat([e])),function(){c.set(C(c.get(),(function(t){return t!==e})))}}var u=e(Bt.none()),c=e([]);return t.on("NodeChange TableSelectorChange",o),{onSetupTable:function(t){return i(t,(function(t){return!1}))},onSetupCellOrRow:function(t){return i(t,(function(t){return"caption"===Jt(t.element())}))},onSetupMergeable:function(t){return i(t,(function(t){return t.mergable().isNone()}))},onSetupUnmergeable:function(t){return i(t,(function(t){return t.unmergable().isNone()}))},resetTargets:o,targets:function(){return u.get()}}}(n,u),a=Jc(n),l=function(t,n,u){var c=Gt(["mousedown","mouseover","mouseup","keyup","keydown"],[]),a=Bt.none(),l=Su(t),f=function(t,n,e){function r(n){Y(n,t.selected()),Y(n,t.firstSelected()),Y(n,t.lastSelected())}function o(n){U(n,t.selected(),"1")}function i(t){u(t),e()}var u=function(n){y(Nt(n,t.selectedSelector()),r)};return{clearBeforeUpdate:u,clear:i,selectRange:function(e,r,u,c){i(e),y(r,o),U(u,t.firstSelected(),"1"),U(c,t.lastSelected(),"1"),n(r,u,c)},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}(lr,(function(n,e,o){u.targets().each((function(i){oe(e).each((function(u){var c=nn.fromDom(t.getDoc()),a=Ie(r,c,l),f=dl(u,i,a);!function(t,n,e,r,o){t.fire("TableSelectionChange",{cells:n,start:e,finish:r,otherCells:o})}(t,n,e,o,f)}))}))}),(function(){!function(t){t.fire("TableSelectionClear")}(t)}));return t.on("init",(function(u){var l=t.getWin(),s=hu(t),d=vu(t),m=function(t,n,e,r){var o=function(t,n,e,r){function o(){i=Bt.none()}var i=Bt.none();return{mousedown:function(t){r.clear(n),i=Kc(t.target(),e)},mouseover:function(o){i.each((function(i){r.clearBeforeUpdate(n),Kc(o.target(),e).each((function(o){ir(i,o,e).each((function(e){var u=e.boxes().getOr([]);(1<u.length||1===u.length&&!En(i,o))&&(r.selectRange(n,u,e.start(),e.finish()),t.selectContents(o))}))}))}))},mouseup:function(t){i.each(o)}}}(ol(t),n,e,r);return{mousedown:o.mousedown,mouseover:o.mouseover,mouseup:o.mouseup}}(l,s,d,f),g=sl(l,s,d,f),p=function(t,n,e,r){var o=ol(t);return function(t,i){r.clearBeforeUpdate(n),ir(t,i,e).each((function(t){var e=t.boxes().getOr([]);r.selectRange(n,e,t.start(),t.finish()),o.selectContents(i),o.collapseSelection()}))}}(l,s,d,f);function h(n,e){!function(t){return!0===t.raw().shiftKey}(n)||(e.kill()&&n.kill(),e.selection().each((function(n){var e=ua.relative(n.start(),n.finish()),r=aa(l,e);t.selection.setRng(r)})))}function v(n){var e=O(n);if(e.raw().shiftKey&&al.isNavigation(e.raw().which)){var r=t.selection.getRng(),o=nn.fromDom(r.startContainer),i=nn.fromDom(r.endContainer);g.keyup(e,o,r.startOffset,i,r.endOffset).each((function(t){h(e,t)}))}}function b(e){var r=O(e);n().each((function(t){t.hideBars()}));var o=t.selection.getRng(),i=nn.fromDom(t.selection.getStart()),u=nn.fromDom(o.startContainer),c=nn.fromDom(o.endContainer),a=yu(i).isRtl()?al.rtl:al.ltr;g.keydown(r,u,o.startOffset,c,o.endOffset,a).each((function(t){h(r,t)})),n().each((function(t){t.showBars()}))}function w(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")}function y(t){return 0===t.button}function C(t){y(t)&&ml(t)&&m.mousedown(O(t))}function x(t){(function(t){return void 0===t.buttons||!!(1&t.buttons)})(t)&&ml(t)&&m.mouseover(O(t))}function S(t){y(t)&&ml(t)&&m.mouseup(O(t))}t.on("TableSelectorChange",(function(t){p(t.start,t.finish)}));var R,T,O=function(t){function n(){t.stopPropagation()}function e(){t.preventDefault()}var r=nn.fromDom(t.target),u=o(e,n);return{target:i(r),x:i(w(t)?t.x:null),y:i(w(t)?t.y:null),stop:n,prevent:e,kill:u,raw:i(t)}},D=(R=e(nn.fromDom(s)),T=e(0),{touchEnd:function(t){var n=nn.fromDom(t.target);if("td"===Jt(n)||"th"===Jt(n)){var e=R.get(),r=T.get();En(e,n)&&t.timeStamp-r<300&&(t.preventDefault(),p(n,n))}R.set(n),T.set(t.timeStamp)}});t.on("mousedown",C),t.on("mouseover",x),t.on("mouseup",S),t.on("touchend",D.touchEnd),t.on("keyup",v),t.on("keydown",b),t.on("NodeChange",(function(){var n=t.selection,e=nn.fromDom(n.getStart()),o=nn.fromDom(n.getEnd());rr.sharedOne(oe,[e,o]).fold((function(){f.clear(s)}),r)})),a=Bt.some(c({mousedown:C,mouseover:x,mouseup:S,keyup:v,keydown:b}))})),{clear:f.clear,destroy:function(){a.each((function(t){}))}}}(n,a.lazyResize,c),f=Ru(n,a.lazyWire),s=e(Bt.none());return tc(n,f,l,u,s),function(n,e,o,i){n.on("BeforeGetContent",(function(t){!0===t.selection&&dr.cata(e.get(),r,(function(e){t.preventDefault(),function(t){return oe(t[0]).map(Se).map((function(t){return[me(t,lr.attributeSelector())]}))}(e).each((function(e){t.content="text"===t.format?function(t){return w(t,(function(t){return t.dom().innerText})).join("")}(e):function(t,n){return w(n,(function(n){return t.selection.serializer.serialize(n.dom(),{})})).join("")}(n,e)}))}),r)})),n.on("BeforeSetContent",(function(e){!0===e.selection&&!0===e.paste&&Bt.from(n.dom.getParent(n.selection.getStart(),"th,td")).each((function(r){var u=nn.fromDom(r);oe(u).each((function(r){var c=C(function(n){var e=t.document.createElement("div");return e.innerHTML=n,wt(nn.fromDom(e))}(e.content),(function(t){return"meta"!==Jt(t)}));if(1===c.length&&"table"===Jt(c[0])){e.preventDefault();var a=nn.fromDom(n.getDoc()),l=ke(a),f=hr.paste(u,c[0],l);o.pasteCells(r,f).each((function(t){n.selection.setRng(t),n.focus(),i.clear(r)}))}}))}))}))}(n,u,f,l),function(t,n){function e(n){return function(){return t.execCommand(n)}}function r(n){var e=n.numRows,r=n.numColumns;t.undoManager.transact((function(){Yu(t,r,e)})),t.addVisual()}var o={text:"Table properties",onSetup:n.onSetupTable,onAction:e("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:n.onSetupTable,onAction:e("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:e("mceTableInsertRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:e("mceTableInsertRowAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:e("mceTableDeleteRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:e("mceTableRowProps"),onSetup:n.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:e("mceTableCutRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:e("mceTableCopyRow"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:e("mceTablePasteRowBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:e("mceTablePasteRowAfter"),onSetup:n.onSetupCellOrRow}],c={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},a=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:e("mceTableInsertColBefore"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:e("mceTableInsertColAfter"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:e("mceTableDeleteCol"),onSetup:n.onSetupCellOrRow}],l={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return a}},f=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:e("mceTableCellProps"),onSetup:n.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:e("mceTableMergeCells"),onSetup:n.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:e("mceTableSplitCells"),onSetup:n.onSetupUnmergeable}],s={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return f}};!1===function(t){return t.getParam("table_grid",!0,"boolean")}(t)?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:e("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:e("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",c),t.ui.registry.addNestedMenuItem("column",l),t.ui.registry.addNestedMenuItem("cell",s),t.ui.registry.addContextMenu("table",{update:function(){return n.resetTargets(),n.targets().fold((function(){return""}),(function(t){return"caption"===Jt(t.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})}(n,c),function(t,n){function e(n){return function(){return t.execCommand(n)}}t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}}),t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:e("mceTableProps"),icon:"table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:e("mceTableDelete"),icon:"table-delete-table",onSetup:n.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:e("mceTableCellProps"),icon:"table-cell-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:e("mceTableMergeCells"),icon:"table-merge-cells",onSetup:n.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:e("mceTableSplitCells"),icon:"table-split-cells",onSetup:n.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:e("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:e("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:e("mceTableDeleteRow"),icon:"table-delete-row",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:e("mceTableRowProps"),icon:"table-row-properties",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:e("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:e("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:e("mceTableDeleteCol"),icon:"table-delete-column",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:e("mceTableCutRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:e("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:e("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:e("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:n.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:e("mceInsertTable"),icon:"table"})}(n,c),function(t){var n=function(t){return t.getParam("table_toolbar","tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol")}(t);0<n.length&&t.ui.registry.addContextToolbar("table",{predicate:function(n){return t.dom.is(n,"table")&&t.getBody().contains(n)},items:n,scope:"node",position:"node"})}(n),n.on("PreInit",(function(){n.serializer.addTempAttr(lr.firstSelected()),n.serializer.addTempAttr(lr.lastSelected())})),function(t){return t.getParam("table_tab_navigation",!0,"boolean")}(n)&&n.on("keydown",(function(t){ga(t,n,f,a.lazyWire)})),n.on("remove",(function(){a.destroy(),l.destroy()})),function(t,n,e,r){return{insertTable:function(n,e){return Yu(t,n,e)},setClipboardRows:function(t){return function(t,n){var e=w(t,nn.fromDom);n.set(Bt.from(e))}(t,n)},getClipboardRows:function(){return function(t){return t.get().fold((function(){}),(function(t){return w(t,(function(t){return t.dom()}))}))}(n)},resizeHandler:e,selectionTargets:r}}(n,s,a,c)}))}(window);